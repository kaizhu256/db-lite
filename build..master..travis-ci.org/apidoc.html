<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    overflow-wrap: break-word;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/kaizhu256/node-db-lite"

    >db-lite (v2018.4.23)</a>
</h1>
<h4>this zero-dependency package will provide a persistent, in-browser database, with a working web-demo</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.db-lite">module db-lite</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable">
            function <span class="apidocSignatureSpan">db-lite.</span>_DbTable
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.assert">
            function <span class="apidocSignatureSpan">db-lite.</span>assert
            <span class="apidocSignatureSpan">(passed, message, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.cliRun">
            function <span class="apidocSignatureSpan">db-lite.</span>cliRun
            <span class="apidocSignatureSpan">(fnc)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.dbCrudRemoveAll">
            function <span class="apidocSignatureSpan">db-lite.</span>dbCrudRemoveAll
            <span class="apidocSignatureSpan">(onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.dbDrop">
            function <span class="apidocSignatureSpan">db-lite.</span>dbDrop
            <span class="apidocSignatureSpan">(onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.dbExport">
            function <span class="apidocSignatureSpan">db-lite.</span>dbExport
            <span class="apidocSignatureSpan">(onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.dbImport">
            function <span class="apidocSignatureSpan">db-lite.</span>dbImport
            <span class="apidocSignatureSpan">(text, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.dbLoad">
            function <span class="apidocSignatureSpan">db-lite.</span>dbLoad
            <span class="apidocSignatureSpan">(onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.dbRowGetItem">
            function <span class="apidocSignatureSpan">db-lite.</span>dbRowGetItem
            <span class="apidocSignatureSpan">(dbRow, key)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.dbRowListGetManyByOperator">
            function <span class="apidocSignatureSpan">db-lite.</span>dbRowListGetManyByOperator
            <span class="apidocSignatureSpan">(dbRowList, fieldName, operator, bb, not)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.dbRowListGetManyByQuery">
            function <span class="apidocSignatureSpan">db-lite.</span>dbRowListGetManyByQuery
            <span class="apidocSignatureSpan">(dbRowList, query, fieldName, not)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.dbRowProject">
            function <span class="apidocSignatureSpan">db-lite.</span>dbRowProject
            <span class="apidocSignatureSpan">(dbRow, fieldList)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.dbRowSetId">
            function <span class="apidocSignatureSpan">db-lite.</span>dbRowSetId
            <span class="apidocSignatureSpan">(dbRow, idIndex)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.dbSave">
            function <span class="apidocSignatureSpan">db-lite.</span>dbSave
            <span class="apidocSignatureSpan">(onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.dbTableCreateMany">
            function <span class="apidocSignatureSpan">db-lite.</span>dbTableCreateMany
            <span class="apidocSignatureSpan">(optionsList, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.dbTableCreateOne">
            function <span class="apidocSignatureSpan">db-lite.</span>dbTableCreateOne
            <span class="apidocSignatureSpan">(options, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.jsonCopy">
            function <span class="apidocSignatureSpan">db-lite.</span>jsonCopy
            <span class="apidocSignatureSpan">(jsonObj)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.jsonStringifyOrdered">
            function <span class="apidocSignatureSpan">db-lite.</span>jsonStringifyOrdered
            <span class="apidocSignatureSpan">(jsonObj, replacer, space)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.listShuffle">
            function <span class="apidocSignatureSpan">db-lite.</span>listShuffle
            <span class="apidocSignatureSpan">(list)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.nop">
            function <span class="apidocSignatureSpan">db-lite.</span>nop
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.normalizeValue">
            function <span class="apidocSignatureSpan">db-lite.</span>normalizeValue
            <span class="apidocSignatureSpan">(type, value, valueDefault)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.objectSetOverride">
            function <span class="apidocSignatureSpan">db-lite.</span>objectSetOverride
            <span class="apidocSignatureSpan">(arg, overrides, depth, env)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.onErrorDefault">
            function <span class="apidocSignatureSpan">db-lite.</span>onErrorDefault
            <span class="apidocSignatureSpan">(error)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.onErrorWithStack">
            function <span class="apidocSignatureSpan">db-lite.</span>onErrorWithStack
            <span class="apidocSignatureSpan">(onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.onParallel">
            function <span class="apidocSignatureSpan">db-lite.</span>onParallel
            <span class="apidocSignatureSpan">(onError, onEach, onRetry)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.replStart">
            function <span class="apidocSignatureSpan">db-lite.</span>replStart
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.serverLog">
            function <span class="apidocSignatureSpan">db-lite.</span>serverLog
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.setTimeoutOnError">
            function <span class="apidocSignatureSpan">db-lite.</span>setTimeoutOnError
            <span class="apidocSignatureSpan">(onError, timeout, error, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.sortCompare">
            function <span class="apidocSignatureSpan">db-lite.</span>sortCompare
            <span class="apidocSignatureSpan">(aa, bb, ii, jj)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.storageClear">
            function <span class="apidocSignatureSpan">db-lite.</span>storageClear
            <span class="apidocSignatureSpan">(onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.storageDefer">
            function <span class="apidocSignatureSpan">db-lite.</span>storageDefer
            <span class="apidocSignatureSpan">(options, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.storageGetItem">
            function <span class="apidocSignatureSpan">db-lite.</span>storageGetItem
            <span class="apidocSignatureSpan">(key, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.storageInit">
            function <span class="apidocSignatureSpan">db-lite.</span>storageInit
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.storageKeys">
            function <span class="apidocSignatureSpan">db-lite.</span>storageKeys
            <span class="apidocSignatureSpan">(onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.storageLength">
            function <span class="apidocSignatureSpan">db-lite.</span>storageLength
            <span class="apidocSignatureSpan">(onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.storageRemoveItem">
            function <span class="apidocSignatureSpan">db-lite.</span>storageRemoveItem
            <span class="apidocSignatureSpan">(key, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite.storageSetItem">
            function <span class="apidocSignatureSpan">db-lite.</span>storageSetItem
            <span class="apidocSignatureSpan">(key, value, onError)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">db-lite.</span>_DbTable.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">db-lite.</span>_debugTryCatchError</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">db-lite.</span>db</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">db-lite.</span>dbTableDict</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">db-lite.</span>local</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">db-lite.</span>storageDeferList</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">db-lite.</span>__dirname</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">db-lite.</span>storageDir</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.db-lite._DbTable">module db-lite._DbTable</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable._DbTable">
            function <span class="apidocSignatureSpan">db-lite.</span>_DbTable
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.db-lite._DbTable.prototype">module db-lite._DbTable.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype._cleanup">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>_cleanup
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype._crudGetManyByQuery">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>_crudGetManyByQuery
            <span class="apidocSignatureSpan">( query, sort, skip, limit, shuffle )</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype._crudGetOneById">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>_crudGetOneById
            <span class="apidocSignatureSpan">(idDict)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype._crudRemoveOneById">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>_crudRemoveOneById
            <span class="apidocSignatureSpan">(idDict, circularList)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype._crudSetOneById">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>_crudSetOneById
            <span class="apidocSignatureSpan">(dbRow)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype._crudUpdateOneById">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>_crudUpdateOneById
            <span class="apidocSignatureSpan">(dbRow)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.crudCountAll">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudCountAll
            <span class="apidocSignatureSpan">(onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.crudCountManyByQuery">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudCountManyByQuery
            <span class="apidocSignatureSpan">(query, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.crudGetManyById">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudGetManyById
            <span class="apidocSignatureSpan">(idDictList, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.crudGetManyByQuery">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudGetManyByQuery
            <span class="apidocSignatureSpan">(options, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.crudGetOneById">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudGetOneById
            <span class="apidocSignatureSpan">(idDict, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.crudGetOneByQuery">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudGetOneByQuery
            <span class="apidocSignatureSpan">(query, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.crudGetOneByRandom">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudGetOneByRandom
            <span class="apidocSignatureSpan">(onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.crudRemoveAll">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudRemoveAll
            <span class="apidocSignatureSpan">(onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.crudRemoveManyById">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudRemoveManyById
            <span class="apidocSignatureSpan">(idDictList, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.crudRemoveManyByQuery">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudRemoveManyByQuery
            <span class="apidocSignatureSpan">(query, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.crudRemoveOneById">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudRemoveOneById
            <span class="apidocSignatureSpan">(idDict, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.crudSetManyById">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudSetManyById
            <span class="apidocSignatureSpan">(dbRowList, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.crudSetOneById">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudSetOneById
            <span class="apidocSignatureSpan">(dbRow, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.crudUpdateManyById">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudUpdateManyById
            <span class="apidocSignatureSpan">(dbRowList, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.crudUpdateManyByQuery">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudUpdateManyByQuery
            <span class="apidocSignatureSpan">(query, dbRow, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.crudUpdateOneById">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudUpdateOneById
            <span class="apidocSignatureSpan">(dbRow, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.drop">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>drop
            <span class="apidocSignatureSpan">(onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.export">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>export
            <span class="apidocSignatureSpan">(onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.idIndexCreate">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>idIndexCreate
            <span class="apidocSignatureSpan">(options, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.idIndexRemove">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>idIndexRemove
            <span class="apidocSignatureSpan">(options, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.db-lite._DbTable.prototype.save">
            function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>save
            <span class="apidocSignatureSpan">(onError)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.db-lite" id="apidoc.module.db-lite">module db-lite</a></h1>


    <h2>
        <a href="#apidoc.element.db-lite._DbTable" id="apidoc.element.db-lite._DbTable">
        function <span class="apidocSignatureSpan">db-lite.</span>_DbTable
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_DbTable = function (options) {
<span class="apidocCodeCommentSpan">/*
 * this function will create a dbTable
 */
</span>    options = local.objectSetOverride(options);
    this.name = String(options.name);
    // register dbTable in dbTableDict
    local.dbTableDict[this.name] = this;
    this.dbRowList = [];
    this.isDirty = null;
    this.idIndexList = [{ isInteger: false, name: &apos;_id&apos;, dict: {} }];
    this.onSaveList = [];
    this.sizeLimit = options.sizeLimit || 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        /*
* this function will create a dbTable with the given options
*/
   var self;
   options = local.objectSetOverride(options);
   // register dbTable
   self = local.dbTableDict[options.name] =
       local.dbTableDict[options.name] || new local.<span class="apidocCodeKeywordSpan">_DbTable</span>(options);
   self.sortDefault = options.sortDefault ||
       self.sortDefault ||
       [{ fieldName: &apos;_timeUpdated&apos;, isDescending: true }];
   // remove idIndex
   local.normalizeValue(&apos;list&apos;, options.idIndexRemoveList).forEach(function (idIndex) {
       self.idIndexRemove(idIndex);
   });
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.assert" id="apidoc.element.db-lite.assert">
        function <span class="apidocSignatureSpan">db-lite.</span>assert
        <span class="apidocSignatureSpan">(passed, message, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">assert = function (passed, message, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will throw the error message if passed is falsey
 */
</span>    var error;
    if (passed) {
        return;
    }
    error = message &amp;&amp; message.message
        // if message is an error-object, then leave it as is
        ? message
        : new Error(typeof message === &apos;string&apos;
            // if message is a string, then leave it as is
            ? message
            // else JSON.stringify message
            : JSON.stringify(message));
    // debug error
    local._debugAssertError = error;
    onError = onError || function (error) {
        throw error;
    };
    onError(error);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            onParallel = function (error, data) {
if (onRetry(error, data)) {
    return;
}
// decrement counter
onParallel.counter -= 1;
// validate counter
local.<span class="apidocCodeKeywordSpan">assert</span>(
    onParallel.counter &gt;= 0 || error || onParallel.error,
    &apos;invalid onParallel.counter = &apos; + onParallel.counter
);
// ensure onError is run only once
if (onParallel.counter &lt; 0) {
    return;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.cliRun" id="apidoc.element.db-lite.cliRun">
        function <span class="apidocSignatureSpan">db-lite.</span>cliRun
        <span class="apidocSignatureSpan">(fnc)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">cliRun = function (fnc) {
<span class="apidocCodeCommentSpan">/*
 * this function will run the cli
 */
</span>    var nop;
    nop = function () {
    /*
     * this function will do nothing
     */
        return;
    };
    local.cliDict._eval = local.cliDict._eval || function () {
    /*
     * code
     * eval code
     */
        local.global.local = local;
        require(&apos;vm&apos;).runInThisContext(process.argv[3]);
    };
    local.cliDict[&apos;--eval&apos;] = local.cliDict[&apos;--eval&apos;] || local.cliDict._eval;
    local.cliDict[&apos;-e&apos;] = local.cliDict[&apos;-e&apos;] || local.cliDict._eval;
    local.cliDict._help = local.cliDict._help || function () {
    /*
     * [none]
     * print help
     */
        var element, result, lengthList, sortDict;
        console.log(require(__dirname + &apos;/package.json&apos;).name + &apos; v&apos; +
            require(__dirname + &apos;/package.json&apos;).version);
        sortDict = {};
        result = [[&apos;[command]&apos;, &apos;[args]&apos;, &apos;[description]&apos;, -1]];
        lengthList = [result[0][0].length, result[0][1].length];
        Object.keys(local.cliDict).sort().forEach(function (key, ii) {
            if (key[0] === &apos;_&apos; &amp;&amp; key !== &apos;_default&apos;) {
                return;
            }
            sortDict[local.cliDict[key].toString()] =
                sortDict[local.cliDict[key].toString()] || (ii + 1);
            element = (/\n +\*(.*)\n +\*(.*)/).exec(local.cliDict[key].toString());
            // coverage-hack - ignore else-statement
            nop(local.global.__coverage__ &amp;&amp; (function () {
                element = element || [&apos;&apos;, &apos;&apos;, &apos;&apos;];
            }()));
            element = [
                key.replace(&apos;_default&apos;, &apos;[none]&apos;) + &apos; &apos;,
                element[1].trim() + &apos; &apos;,
                element[2].trim(),
                (sortDict[local.cliDict[key].toString()] &lt;&lt; 8) + ii
            ];
            result.push(element);
            lengthList.forEach(function (length, jj) {
                lengthList[jj] = Math.max(element[jj].length, length);
            });
        });
        result.sort(function (aa, bb) {
            return aa[3] &lt; bb[3]
                ? -1
                : 1;
        });
        console.log(&apos;usage:   &apos; + __filename + &apos; [command] [args]&apos;);
        console.log(&apos;example: &apos; + __filename + &apos; --eval    &apos; +
            &apos;&quot;console.log(\&apos;hello world\&apos;)&quot;\n&apos;);
        result.forEach(function (element, ii) {
            lengthList.forEach(function (length, jj) {
                while (element[jj].length &lt; length) {
                    element[jj] += &apos;-&apos;;
                }
            });
            element = element.slice(0, 3).join(&apos;---- &apos;);
            if (!ii) {
                element = element.replace((/-/g), &apos; &apos;);
            }
            console.log(element);
        });
    };
    local.cliDict[&apos;--help&apos;] = local.cliDict[&apos;--help&apos;] || local.cliDict._help;
    local.cliDict[&apos;-h&apos;] = local.cliDict[&apos;-h&apos;] || local.cliDict._help;
    local.cliDict._default = local.cliDict._default || local.cliDict._help;
    local.cliDict.help = local.cliDict.help || local.cliDict._help;
    local.cliDict._interactive = local.cliDict._interactive || function () {
    /*
     * [none]
     * start interactive-mode
     */
        local.global.local = local;
        local.replStart();
    };
    if (local.replStart) {
        local.cliDict[&apos;--interactive&apos;] = local.cliDict[&apos;--interactive&apos;] ||
            local.cliDict._interactive;
        local.cliDict[&apos;-i&apos;] = local.cliDict[&apos;-i&apos;] || local.cliDict._interactive;
    }
    local.cliDict._version = local.cliDict._version || function () {
    /*
     * [none]
     * print version
     */
        console.log(require(__dirname + &apos;/package.json&apos;).version);
    };
    local...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
         */
            local.storageRemoveItem(&apos;dbTable.&apos; + process.argv[3] + &apos;.json&apos;, function (error) {
                // validate no error occurred
                local.assert(!error, error);
                local.cliDict.dbTableList();
            });
        };
        local.<span class="apidocCodeKeywordSpan">cliRun</span>();
        break;
    }
}());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.dbCrudRemoveAll" id="apidoc.element.db-lite.dbCrudRemoveAll">
        function <span class="apidocSignatureSpan">db-lite.</span>dbCrudRemoveAll
        <span class="apidocSignatureSpan">(onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dbCrudRemoveAll = function (onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will remove all dbRow&apos;s from the db
 */
</span>    var onParallel;
    onParallel = local.onParallel(function (error) {
        local.setTimeoutOnError(onError, 0, error);
    });
    onParallel.counter += 1;
    Object.keys(local.dbTableDict).forEach(function (key) {
        onParallel.counter += 1;
        local.dbTableDict[key].crudRemoveAll(onParallel);
    });
    onParallel();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

local.testCase_dbTable_persistence = function (options, onError) {
/*
 * this function will test dbTable&apos;s persistence handling-behavior
 */
    options = {};
    // remove all dbRow&apos;s from db
    local.<span class="apidocCodeKeywordSpan">dbCrudRemoveAll</span>();
    // drop db
    local.dbDrop();
    // save db
    local.dbSave();
    // load db
    local.dbLoad();
    // import db
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.dbDrop" id="apidoc.element.db-lite.dbDrop">
        function <span class="apidocSignatureSpan">db-lite.</span>dbDrop
        <span class="apidocSignatureSpan">(onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dbDrop = function (onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will drop the db
 */
</span>    var onParallel;
    onParallel = local.onParallel(function (error) {
        local.setTimeoutOnError(onError, 0, error);
    });
    onParallel.counter += 1;
    onParallel.counter += 1;
    local.storageClear(onParallel);
    Object.keys(local.dbTableDict).forEach(function (key) {
        onParallel.counter += 1;
        local.dbTableDict[key].drop(onParallel);
    });
    onParallel();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        local.db.dbImport(reader.result);
        console.log(&apos;... imported db-lite database&apos;);
    });
    reader.readAsText(tmp);
    break;
case &apos;dbResetButton1&apos;:
    console.log(&apos;resetting db-lite database ...&apos;);
    local.db.<span class="apidocCodeKeywordSpan">dbDrop</span>(function () {
        console.log(&apos;... resetted db-lite database&apos;);
    });
    break;
}
if (document.querySelector(&apos;#inputTextareaEval1&apos;) &amp;&amp; (!event || (event &amp;&amp;
        event.currentTarget &amp;&amp;
        event.currentTarget.className &amp;&amp;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.dbExport" id="apidoc.element.db-lite.dbExport">
        function <span class="apidocSignatureSpan">db-lite.</span>dbExport
        <span class="apidocSignatureSpan">(onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dbExport = function (onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will export the db as serialized text
 */
</span>    var result;
    result = &apos;&apos;;
    Object.keys(local.dbTableDict).forEach(function (key) {
        result += local.dbTableDict[key].export();
        result += &apos;\n\n&apos;;
    });
    return local.setTimeoutOnError(onError, 0, null, result.trim());
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    } else {
        local.uiAnimateSlideUp(document.querySelector(&apos;#testReportDiv1&apos;));
        document.querySelector(&apos;#testRunButton1&apos;).textContent = &apos;run internal test&apos;;
    }
    break;
// custom-case
case &apos;dbExportButton1&apos;:
    tmp = window.URL.createObjectURL(new window.Blob([local.db.<span class="apidocCodeKeywordSpan">dbExport</span>()]));
    document.querySelector(&apos;#dbExportA1&apos;).href = tmp;
    document.querySelector(&apos;#dbExportA1&apos;).click();
    setTimeout(function () {
        window.URL.revokeObjectURL(tmp);
    }, 30000);
    break;
case &apos;dbImportButton1&apos;:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.dbImport" id="apidoc.element.db-lite.dbImport">
        function <span class="apidocSignatureSpan">db-lite.</span>dbImport
        <span class="apidocSignatureSpan">(text, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dbImport = function (text, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will import the serialized text into the db
 */
</span>    var dbTable;
    local.modeImport = true;
    setTimeout(function () {
        local.modeImport = null;
    });
    text.replace((/^(\w\S*?) (\S+?) (\S.*?)$/gm), function (
        match0,
        match1,
        match2,
        match3
    ) {
        // jslint-hack
        local.nop(match0);
        switch (match2) {
        case &apos;dbRowSet&apos;:
            dbTable = local.dbTableCreateOne({ isLoaded: true, name: match1 });
            dbTable.crudSetOneById(JSON.parse(match3));
            break;
        case &apos;idIndexCreate&apos;:
            dbTable = local.dbTableCreateOne({ isLoaded: true, name: match1 });
            dbTable.idIndexCreate(JSON.parse(match3));
            break;
        case &apos;sizeLimit&apos;:
            dbTable = local.dbTableCreateOne({ isLoaded: true, name: match1 });
            dbTable.sizeLimit = JSON.parse(match3);
            break;
        case &apos;sortDefault&apos;:
            dbTable = local.dbTableCreateOne({ isLoaded: true, name: match1 });
            break;
        default:
            local.onErrorDefault(new Error(&apos;dbImport - invalid operation - &apos; + match0));
        }
    });
    local.modeImport = null;
    return local.setTimeoutOnError(onError);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
                return key.indexOf(&apos;dbTable.&apos;) === 0;
            })
            .forEach(function (key) {
                onParallel.counter += 1;
                local.storageGetItem(key, function (error, data) {
                    onParallel.counter += 1;
                    onParallel(error);
                    local.<span class="apidocCodeKeywordSpan">dbImport</span>(data, onParallel);
                });
            });
        onParallel();
    });
};

local.dbRowGetItem = function (dbRow, key) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.dbLoad" id="apidoc.element.db-lite.dbLoad">
        function <span class="apidocSignatureSpan">db-lite.</span>dbLoad
        <span class="apidocSignatureSpan">(onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dbLoad = function (onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will load the db from storage
 */
</span>    var onParallel;
    onParallel = local.onParallel(function (error) {
        local.setTimeoutOnError(onError, 0, error);
    });
    local.storageKeys(function (error, data) {
        onParallel.counter += 1;
        onParallel.counter += 1;
        onParallel(error);
        local.normalizeValue(&apos;list&apos;, data)
            .filter(function (key) {
                return key.indexOf(&apos;dbTable.&apos;) === 0;
            })
            .forEach(function (key) {
                onParallel.counter += 1;
                local.storageGetItem(key, function (error, data) {
                    onParallel.counter += 1;
                    onParallel(error);
                    local.dbImport(data, onParallel);
                });
            });
        onParallel();
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    // init utility2_rollup
    local = local.global.utility2_rollup || (local.modeJs === &apos;browser&apos;
        ? local.global.utility2_db
        : require(&apos;db-lite&apos;));
    // init exports
    local.global.local = local;
    // load db
    local.db.<span class="apidocCodeKeywordSpan">dbLoad</span>(function () {
        console.log(&apos;db loaded from &apos; + local.storageDir);
    });
}());
switch (local.modeJs) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.dbRowGetItem" id="apidoc.element.db-lite.dbRowGetItem">
        function <span class="apidocSignatureSpan">db-lite.</span>dbRowGetItem
        <span class="apidocSignatureSpan">(dbRow, key)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dbRowGetItem = function (dbRow, key) {
<span class="apidocCodeCommentSpan">/*
 * this function will get the item with the given key from dbRow
 */
</span>    var ii, value;
    value = dbRow;
    key = String(key).split(&apos;.&apos;);
    // optimization - for-loop
    for (ii = 0; ii &lt; key.length &amp;&amp; typeof value === &apos;object&apos; &amp;&amp; value; ii += 1) {
        value = value[key[ii]];
    }
    return value === undefined
        ? null
        : value;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// optimization - for-loop
for (ii = 0; ii &lt; result.length; ii += 1) {
    result[ii].$meta.ii = ii;
}
if (element.isDescending) {
    result.sort(function (aa, bb) {
        return -local.sortCompare(
            local.<span class="apidocCodeKeywordSpan">dbRowGetItem</span>(aa, element.fieldName),
            local.dbRowGetItem(bb, element.fieldName),
            aa.$meta.ii,
            bb.$meta.ii
        );
    });
} else {
    result.sort(function (aa, bb) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.dbRowListGetManyByOperator" id="apidoc.element.db-lite.dbRowListGetManyByOperator">
        function <span class="apidocSignatureSpan">db-lite.</span>dbRowListGetManyByOperator
        <span class="apidocSignatureSpan">(dbRowList, fieldName, operator, bb, not)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dbRowListGetManyByOperator = function (dbRowList, fieldName, operator, bb, not) {
<span class="apidocCodeCommentSpan">/*
 * this function will get the dbRow&apos;s in dbRowList with the given operator
 */
</span>    var ii, jj, result, fieldValue, test, typeof2;
    result = [];
    typeof2 = typeof bb;
    if (bb &amp;&amp; typeof2 === &apos;object&apos;) {
        switch (operator) {
        case &apos;$in&apos;:
        case &apos;$nin&apos;:
        case &apos;$regex&apos;:
            break;
        default:
            return result;
        }
    }
    switch (operator) {
    case &apos;$eq&apos;:
        test = function (aa, bb) {
            return aa === bb;
        };
        break;
    case &apos;$exists&apos;:
        bb = !bb;
        test = function (aa, bb) {
            return !((aa === null) ^ bb);
        };
        break;
    case &apos;$gt&apos;:
        test = function (aa, bb, typeof1, typeof2) {
            return typeof1 === typeof2 &amp;&amp; aa &gt; bb;
        };
        break;
    case &apos;$gte&apos;:
        test = function (aa, bb, typeof1, typeof2) {
            return typeof1 === typeof2 &amp;&amp; aa &gt;= bb;
        };
        break;
    case &apos;$in&apos;:
        if (bb &amp;&amp; typeof bb.indexOf === &apos;function&apos;) {
            if (typeof2 === &apos;string&apos;) {
                test = function (aa, bb, typeof1, typeof2) {
                    return typeof1 === typeof2 &amp;&amp; bb.indexOf(aa) &gt;= 0;
                };
            } else {
                test = function (aa, bb) {
                    return bb.indexOf(aa) &gt;= 0;
                };
            }
        }
        break;
    case &apos;$lt&apos;:
        test = function (aa, bb, typeof1, typeof2) {
            return typeof1 === typeof2 &amp;&amp; aa &lt; bb;
        };
        break;
    case &apos;$lte&apos;:
        test = function (aa, bb, typeof1, typeof2) {
            return typeof1 === typeof2 &amp;&amp; aa &lt;= bb;
        };
        break;
    case &apos;$ne&apos;:
        test = function (aa, bb) {
            return aa !== bb;
        };
        break;
    case &apos;$nin&apos;:
        if (bb &amp;&amp; typeof bb.indexOf === &apos;function&apos;) {
            if (typeof2 === &apos;string&apos;) {
                test = function (aa, bb, typeof1, typeof2) {
                    return typeof1 === typeof2 &amp;&amp; bb.indexOf(aa) &lt; 0;
                };
            } else {
                test = function (aa, bb) {
                    return bb.indexOf(aa) &lt; 0;
                };
            }
        }
        break;
    case &apos;$regex&apos;:
        if (bb &amp;&amp; typeof bb.test === &apos;function&apos;) {
            test = function (aa, bb) {
                return bb.test(aa);
            };
        }
        break;
    case &apos;$typeof&apos;:
        test = function (aa, bb, typeof1) {
            // jslint-hack
            local.nop(aa);
            return typeof1 === bb;
        };
        break;
    }
    if (!test) {
        return result;
    }
    // optimization - for-loop
    for (ii = dbRowList.length - 1; ii &gt;= 0; ii -= 1) {
        fieldValue = local.dbRowGetItem(dbRowList[ii], fieldName);
        // normalize to list
        if (!Array.isArray(fieldValue)) {
            fieldValue = [fieldValue];
        }
        // optimization - for-loop
        for (jj = fieldValue.length - 1; jj &gt;= 0; jj -= 1) {
            if (not ^ test(fieldValue[jj], bb, typeof fieldValue[jj], typeof2)) {
                result.push(dbRowList[ii]);
                break;
            }
        }
    }
    return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* this function will get the dbRow&apos;s in dbRowList with the given query
*/
   var bb, dbRowDict, result;
   // optimization - convert to boolean
   not = !!not;
   result = dbRowList;
   if (!(typeof query === &apos;object&apos; &amp;&amp; query)) {
       result = local.<span class="apidocCodeKeywordSpan">dbRowListGetManyByOperator</span>(result, fieldName, &apos;$eq&apos;,
query, not);
       return result;
   }
   Object.keys(query).some(function (key) {
       bb = query[key];
       switch (key) {
       case &apos;$not&apos;:
           key = fieldName;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.dbRowListGetManyByQuery" id="apidoc.element.db-lite.dbRowListGetManyByQuery">
        function <span class="apidocSignatureSpan">db-lite.</span>dbRowListGetManyByQuery
        <span class="apidocSignatureSpan">(dbRowList, query, fieldName, not)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dbRowListGetManyByQuery = function (dbRowList, query, fieldName, not) {
<span class="apidocCodeCommentSpan">/*
 * this function will get the dbRow&apos;s in dbRowList with the given query
 */
</span>    var bb, dbRowDict, result;
    // optimization - convert to boolean
    not = !!not;
    result = dbRowList;
    if (!(typeof query === &apos;object&apos; &amp;&amp; query)) {
        result = local.dbRowListGetManyByOperator(result, fieldName, &apos;$eq&apos;, query, not);
        return result;
    }
    Object.keys(query).some(function (key) {
        bb = query[key];
        switch (key) {
        case &apos;$not&apos;:
            key = fieldName;
            not = !not;
            break;
        case &apos;$or&apos;:
            if (!Array.isArray(bb)) {
                break;
            }
            dbRowDict = {};
            bb.forEach(function (query) {
                // recurse
                local.dbRowListGetManyByQuery(result, query).forEach(function (dbRow) {
                    dbRowDict[dbRow._id] = dbRow;
                });
            });
            result = Object.keys(dbRowDict).map(function (id) {
                return dbRowDict[id];
            });
            return !result.length;
        }
        if (key[0] === &apos;$&apos;) {
            result = local.dbRowListGetManyByOperator(result, fieldName, key, bb, not);
            return !result.length;
        }
        // recurse
        result = local.dbRowListGetManyByQuery(result, bb, key, not);
        return !result.length;
    });
    return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* this function will get the dbRow&apos;s in the dbTable,
* with the given query, sort, skip, and limit
*/
   var ii, result;
   result = this.dbRowList;
   // get by query
   if (result.length &amp;&amp; query &amp;&amp; Object.keys(query).length) {
       result = local.<span class="apidocCodeKeywordSpan">dbRowListGetManyByQuery</span>(this.dbRowList, query);
   }
   // sort
   local.normalizeValue(&apos;list&apos;, sort).forEach(function (element) {
       // bug-workaround - v8 does not have stable-sort
       // optimization - for-loop
       for (ii = 0; ii &lt; result.length; ii += 1) {
           result[ii].$meta.ii = ii;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.dbRowProject" id="apidoc.element.db-lite.dbRowProject">
        function <span class="apidocSignatureSpan">db-lite.</span>dbRowProject
        <span class="apidocSignatureSpan">(dbRow, fieldList)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dbRowProject = function (dbRow, fieldList) {
<span class="apidocCodeCommentSpan">/*
 * this function will deepcopy and project the dbRow with the given fieldList
 */
</span>    var result;
    if (!dbRow) {
        return null;
    }
    // handle list-case
    if (Array.isArray(dbRow)) {
        return dbRow.map(function (dbRow) {
            // recurse
            return local.dbRowProject(dbRow, fieldList);
        });
    }
    // normalize to list
    if (!(Array.isArray(fieldList) &amp;&amp; fieldList.length)) {
        fieldList = Object.keys(dbRow);
    }
    result = {};
    fieldList.forEach(function (key) {
        if (key[0] !== &apos;$&apos;) {
            result[key] = dbRow[key];
        }
    });
    return JSON.parse(local.jsonStringifyOrdered(result));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
local._DbTable.prototype.crudGetManyById = function (idDictList, onError) {
/*
 * this function will get the dbRow&apos;s in the dbTable with the given idDictList
 */
    var self;
    this._cleanup();
    self = this;
    return local.setTimeoutOnError(onError, 0, null, local.<span class="apidocCodeKeywordSpan">dbRowProject</span>(
        local.normalizeValue(&apos;list&apos;, idDictList).map(function (idDict) {
            return self._crudGetOneById(idDict);
        })
    ));
};

local._DbTable.prototype.crudGetManyByQuery = function (options, onError) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.dbRowSetId" id="apidoc.element.db-lite.dbRowSetId">
        function <span class="apidocSignatureSpan">db-lite.</span>dbRowSetId
        <span class="apidocSignatureSpan">(dbRow, idIndex)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dbRowSetId = function (dbRow, idIndex) {
<span class="apidocCodeCommentSpan">/*
 * this function will set a random and unique id into dbRow for the given idIndex,
 * if it does not exist
 */
</span>    var id;
    id = dbRow[idIndex.name];
    if (typeof id !== &apos;number&apos; &amp;&amp; typeof id !== &apos;string&apos;) {
        do {
            id = idIndex.isInteger
                ? (1 + Math.random()) * 0x10000000000000
                : &apos;a&apos; + ((1 + Math.random()) * 0x10000000000000).toString(36).slice(1);
        // optimization - hasOwnProperty
        } while (idIndex.dict.hasOwnProperty(id));
        dbRow[idIndex.name] = id;
    }
    return id;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
dbRow = local.jsonCopy(dbRow);
// remove existing dbRow
existing = this._crudRemoveOneById(dbRow) || dbRow;
// init meta
dbRow.$meta = { isRemoved: null };
this.idIndexList.forEach(function (idIndex) {
    // auto-set id
    id = local.<span class="apidocCodeKeywordSpan">dbRowSetId</span>(existing, idIndex);
    // copy id from existing to dbRow
    dbRow[idIndex.name] = id;
    // set dbRow
    idIndex.dict[id] = dbRow;
});
// update dbRowList
this.dbRowList.push(dbRow);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.dbSave" id="apidoc.element.db-lite.dbSave">
        function <span class="apidocSignatureSpan">db-lite.</span>dbSave
        <span class="apidocSignatureSpan">(onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dbSave = function (onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will save the db to storage
 */
</span>    var onParallel;
    onParallel = local.onParallel(function (error) {
        local.setTimeoutOnError(onError, 0, error);
    });
    onParallel.counter += 1;
    Object.keys(local.dbTableDict).forEach(function (key) {
        onParallel.counter += 1;
        local.dbTableDict[key].save(onParallel);
    });
    onParallel();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
         */
options = {};
// remove all dbRow&apos;s from db
local.dbCrudRemoveAll();
// drop db
local.dbDrop();
// save db
local.<span class="apidocCodeKeywordSpan">dbSave</span>();
// load db
local.dbLoad();
// import db
local.dbImport(&apos;testCase_dbTable_persistence idIndexCreate {&quot;name&quot;:&quot;_id&quot;}\n&apos; +
    &apos;testCase_dbTable_persistence idIndexCreate {&quot;name&quot;:&quot;id2&quot;}\n&apos; +
    &apos;testCase_dbTable_persistence sizeLimit 0\n&apos; +
    &apos;testCase_dbTable_persistence sortDefault []\n&apos; +
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.dbTableCreateMany" id="apidoc.element.db-lite.dbTableCreateMany">
        function <span class="apidocSignatureSpan">db-lite.</span>dbTableCreateMany
        <span class="apidocSignatureSpan">(optionsList, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dbTableCreateMany = function (optionsList, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will set the optionsList into the db
 */
</span>    var onParallel, result;
    onParallel = local.onParallel(function (error) {
        local.setTimeoutOnError(onError, 0, error, result);
    });
    onParallel.counter += 1;
    result = local.normalizeValue(&apos;list&apos;, optionsList).map(function (options) {
        onParallel.counter += 1;
        return local.dbTableCreateOne(options, onParallel);
    });
    return local.setTimeoutOnError(onParallel, 0, null, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

local.testCase_dbTable_crudNullCase = function (options, onError) {
/*
 * this function will test dbTable&apos;s crud null-case handling-behavior
 */
    options = {};
    // test dbTableCreateMany&apos;s null-case handling-behavior
    local.<span class="apidocCodeKeywordSpan">dbTableCreateMany</span>();
    // test dbTableCreateOne&apos;s onError handling-behavior
    options.dbTable = local.dbTableCreateOne({
        name: &apos;testCase_dbTable_crudNullCase&apos;
    }, local.onErrorDefault);
    // test dbTableCreateOne&apos;s null-case handling-behavior
    options.dbTable = local.dbTableCreateOne({
        name: &apos;testCase_dbTable_crudNullCase&apos;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.dbTableCreateOne" id="apidoc.element.db-lite.dbTableCreateOne">
        function <span class="apidocSignatureSpan">db-lite.</span>dbTableCreateOne
        <span class="apidocSignatureSpan">(options, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dbTableCreateOne = function (options, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will create a dbTable with the given options
 */
</span>    var self;
    options = local.objectSetOverride(options);
    // register dbTable
    self = local.dbTableDict[options.name] =
        local.dbTableDict[options.name] || new local._DbTable(options);
    self.sortDefault = options.sortDefault ||
        self.sortDefault ||
        [{ fieldName: &apos;_timeUpdated&apos;, isDescending: true }];
    // remove idIndex
    local.normalizeValue(&apos;list&apos;, options.idIndexRemoveList).forEach(function (idIndex) {
        self.idIndexRemove(idIndex);
    });
    // create idIndex
    local.normalizeValue(&apos;list&apos;, options.idIndexCreateList).forEach(function (idIndex) {
        self.idIndexCreate(idIndex);
    });
    // upsert dbRow
    self.crudSetManyById(options.dbRowList);
    // restore dbTable from persistent-storage
    self.isLoaded = self.isLoaded || options.isLoaded;
    if (!self.isLoaded) {
        local.storageGetItem(&apos;dbTable.&apos; + self.name + &apos;.json&apos;, function (error, data) {
            // validate no error occurred
            local.assert(!error, error);
            if (!self.isLoaded) {
                local.dbImport(data);
            }
            self.isLoaded = true;
            local.setTimeoutOnError(onError, 0, null, self);
        });
        return self;
    }
    return local.setTimeoutOnError(onError, 0, null, self);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*
* this zero-dependency package will provide a persistent, in-browser database
*
* browser example:
*     &lt;script src=&quot;assets.db-lite.js&quot;&gt;&lt;/script&gt;
*     &lt;script&gt;
*     var dbTable1;
*     dbTable1 = window.dbTable1 = window.utility2_db.<span class="apidocCodeKeywordSpan">dbTableCreateOne</span>({ name: &quot;
dbTable1&quot; });
*     dbTable1.idIndexCreate({ name: &quot;field1&quot; });
*     dbTable1.crudSetOneById({ field1: &quot;hello&quot;, field2: &quot;world&quot; });
*     console.log(dbTable1.crudGetManyByQuery({
*         limit: Infinity,
*         query: { field1: &quot;hello&quot; },
*         skip: 0,
*         sort: [{ fieldName: &apos;field1&apos;, isDescending: false }]
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.jsonCopy" id="apidoc.element.db-lite.jsonCopy">
        function <span class="apidocSignatureSpan">db-lite.</span>jsonCopy
        <span class="apidocSignatureSpan">(jsonObj)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">jsonCopy = function (jsonObj) {
<span class="apidocCodeCommentSpan">/*
 * this function will return a deep-copy of the jsonObj
 */
</span>    return jsonObj === undefined
        ? undefined
        : JSON.parse(JSON.stringify(jsonObj));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
                return;
            }
            // recurse
            normalize(dbRow[key]);
        });
    }
};
dbRow = local.<span class="apidocCodeKeywordSpan">jsonCopy</span>(typeof dbRow === &apos;object&apos; &amp;&amp; dbRow
    ? dbRow
    : {});
// update timestamp
timeNow = new Date().toISOString();
dbRow._timeCreated = dbRow._timeCreated || timeNow;
if (!local.modeImport) {
    dbRow._timeUpdated = timeNow;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.jsonStringifyOrdered" id="apidoc.element.db-lite.jsonStringifyOrdered">
        function <span class="apidocSignatureSpan">db-lite.</span>jsonStringifyOrdered
        <span class="apidocSignatureSpan">(jsonObj, replacer, space)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">jsonStringifyOrdered = function (jsonObj, replacer, space) {
<span class="apidocCodeCommentSpan">/*
 * this function will JSON.stringify the jsonObj,
 * with object-keys sorted and circular-references removed
 */
</span>    var circularList, stringify, tmp;
    stringify = function (jsonObj) {
    /*
     * this function will recursively JSON.stringify the jsonObj,
     * with object-keys sorted and circular-references removed
     */
        // if jsonObj is not an object or function, then JSON.stringify as normal
        if (!(jsonObj &amp;&amp;
                typeof jsonObj === &apos;object&apos; &amp;&amp;
                typeof jsonObj.toJSON !== &apos;function&apos;)) {
            return JSON.stringify(jsonObj);
        }
        // ignore circular-reference
        if (circularList.indexOf(jsonObj) &gt;= 0) {
            return;
        }
        circularList.push(jsonObj);
        // if jsonObj is an array, then recurse its jsonObjs
        if (Array.isArray(jsonObj)) {
            return &apos;[&apos; + jsonObj.map(function (jsonObj) {
                // recurse
                tmp = stringify(jsonObj);
                return typeof tmp === &apos;string&apos;
                    ? tmp
                    : &apos;null&apos;;
            }).join(&apos;,&apos;) + &apos;]&apos;;
        }
        // if jsonObj is not an array, then recurse its items with object-keys sorted
        return &apos;{&apos; + Object.keys(jsonObj)
            // sort object-keys
            .sort()
            .map(function (key) {
                // recurse
                tmp = stringify(jsonObj[key]);
                if (typeof tmp === &apos;string&apos;) {
                    return JSON.stringify(key) + &apos;:&apos; + tmp;
                }
            })
            .filter(function (jsonObj) {
                return typeof jsonObj === &apos;string&apos;;
            })
            .join(&apos;,&apos;) + &apos;}&apos;;
    };
    circularList = [];
    // try to derefernce all properties in jsonObj
    (function () {
        try {
            jsonObj = JSON.parse(JSON.stringify(jsonObj));
        } catch (ignore) {
        }
    }());
    return JSON.stringify(typeof jsonObj === &apos;object&apos; &amp;&amp; jsonObj
        // recurse
        ? JSON.parse(stringify(jsonObj))
        : jsonObj, replacer, space);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
    result = {};
    fieldList.forEach(function (key) {
        if (key[0] !== &apos;$&apos;) {
            result[key] = dbRow[key];
        }
    });
    return JSON.parse(local.<span class="apidocCodeKeywordSpan">jsonStringifyOrdered</span>(result));
};

local.dbRowSetId = function (dbRow, idIndex) {
/*
 * this function will set a random and unique id into dbRow for the given idIndex,
 * if it does not exist
 */
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.listShuffle" id="apidoc.element.db-lite.listShuffle">
        function <span class="apidocSignatureSpan">db-lite.</span>listShuffle
        <span class="apidocSignatureSpan">(list)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listShuffle = function (list) {
<span class="apidocCodeCommentSpan">/*
 * https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle
 * this function will inplace shuffle the list, via fisher-yates algorithm
 */
</span>    var ii, random, swap;
    for (ii = list.length - 1; ii &gt; 0; ii -= 1) {
        // coerce to finite integer
        random = (Math.random() * (ii + 1)) | 0;
        swap = list[ii];
        list[ii] = list[random];
        list[random] = swap;
    }
    return list;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.nop" id="apidoc.element.db-lite.nop">
        function <span class="apidocSignatureSpan">db-lite.</span>nop
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">nop = function () {
<span class="apidocCodeCommentSpan">/*
 * this function will do nothing
 */
</span>    return;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
self.socket = { end: self.nop, on: self.nop, write: self.nop };
// init process.stdout
process.stdout._writeDefault = process.stdout._writeDefault ||
    process.stdout._write;
process.stdout._write = function (chunk, encoding, callback) {
    process.stdout._writeDefault(chunk, encoding, callback);
    // coverage-hack - ignore else-statement
    self.<span class="apidocCodeKeywordSpan">nop</span>(self.socket.writable &amp;&amp; (function () {
        self.socket.write(chunk, encoding);
    }()));
};
// start tcp-server
global.utility2_serverReplTcp1 = require(&apos;net&apos;).createServer(function (socket) {
    // init socket
    self.socket = socket;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.normalizeValue" id="apidoc.element.db-lite.normalizeValue">
        function <span class="apidocSignatureSpan">db-lite.</span>normalizeValue
        <span class="apidocSignatureSpan">(type, value, valueDefault)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">normalizeValue = function (type, value, valueDefault) {
<span class="apidocCodeCommentSpan">/*
 * this function will normalize the value by type
 */
</span>    switch (type) {
    case &apos;list&apos;:
        return Array.isArray(value)
            ? value
            : valueDefault || [];
    case &apos;number&apos;:
        return Number(value) || valueDefault || 0;
    case &apos;string&apos;:
        return typeof value === &apos;string&apos;
            ? value
            : valueDefault || &apos;&apos;;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var ii, result;
result = this.dbRowList;
// get by query
if (result.length &amp;&amp; query &amp;&amp; Object.keys(query).length) {
    result = local.dbRowListGetManyByQuery(this.dbRowList, query);
}
// sort
local.<span class="apidocCodeKeywordSpan">normalizeValue</span>(&apos;list&apos;, sort).forEach(function (element) {
    // bug-workaround - v8 does not have stable-sort
    // optimization - for-loop
    for (ii = 0; ii &lt; result.length; ii += 1) {
        result[ii].$meta.ii = ii;
    }
    if (element.isDescending) {
        result.sort(function (aa, bb) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.objectSetOverride" id="apidoc.element.db-lite.objectSetOverride">
        function <span class="apidocSignatureSpan">db-lite.</span>objectSetOverride
        <span class="apidocSignatureSpan">(arg, overrides, depth, env)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">objectSetOverride = function (arg, overrides, depth, env) {
<span class="apidocCodeCommentSpan">/*
 * this function will recursively set overrides for items in the arg
 */
</span>    arg = arg || {};
    env = env || (typeof process === &apos;object&apos; &amp;&amp; process.env) || {};
    overrides = overrides || {};
    Object.keys(overrides).forEach(function (key) {
        var arg2, overrides2;
        arg2 = arg[key];
        overrides2 = overrides[key];
        if (overrides2 === undefined) {
            return;
        }
        // if both arg2 and overrides2 are non-null and non-array objects,
        // then recurse with arg2 and overrides2
        if (depth &gt; 1 &amp;&amp;
                // arg2 is a non-null and non-array object
                typeof arg2 === &apos;object&apos; &amp;&amp; arg2 &amp;&amp; !Array.isArray(arg2) &amp;&amp;
                // overrides2 is a non-null and non-array object
                typeof overrides2 === &apos;object&apos; &amp;&amp; overrides2 &amp;&amp;
                !Array.isArray(overrides2)) {
            local.objectSetOverride(arg2, overrides2, depth - 1, env);
            return;
        }
        // else set arg[key] with overrides[key]
        arg[key] = arg === env
            // if arg is env, then overrides falsey value with empty string
            ? overrides2 || &apos;&apos;
            : overrides2;
    });
    return arg;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// then recurse with arg2 and overrides2
if (depth &gt; 1 &amp;&amp;
        // arg2 is a non-null and non-array object
        typeof arg2 === &apos;object&apos; &amp;&amp; arg2 &amp;&amp; !Array.isArray(arg2) &amp;&amp;
        // overrides2 is a non-null and non-array object
        typeof overrides2 === &apos;object&apos; &amp;&amp; overrides2 &amp;&amp;
        !Array.isArray(overrides2)) {
    local.<span class="apidocCodeKeywordSpan">objectSetOverride</span>(arg2, overrides2, depth - 1, env);
    return;
}
// else set arg[key] with overrides[key]
arg[key] = arg === env
    // if arg is env, then overrides falsey value with empty string
    ? overrides2 || &apos;&apos;
    : overrides2;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.onErrorDefault" id="apidoc.element.db-lite.onErrorDefault">
        function <span class="apidocSignatureSpan">db-lite.</span>onErrorDefault
        <span class="apidocSignatureSpan">(error)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onErrorDefault = function (error) {
<span class="apidocCodeCommentSpan">/*
 * this function will if error exists, then print error.stack to stderr
 */
</span>    if (error &amp;&amp; !local.global.__coverage__) {
        console.error(error);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            dbTable = local.dbTableCreateOne({ isLoaded: true, name: match1 });
            dbTable.sizeLimit = JSON.parse(match3);
            break;
        case &apos;sortDefault&apos;:
            dbTable = local.dbTableCreateOne({ isLoaded: true, name: match1 });
            break;
        default:
            local.<span class="apidocCodeKeywordSpan">onErrorDefault</span>(new Error(&apos;dbImport - invalid operation - &apos
; + match0));
        }
    });
    local.modeImport = null;
    return local.setTimeoutOnError(onError);
};

local.dbLoad = function (onError) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.onErrorWithStack" id="apidoc.element.db-lite.onErrorWithStack">
        function <span class="apidocSignatureSpan">db-lite.</span>onErrorWithStack
        <span class="apidocSignatureSpan">(onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onErrorWithStack = function (onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will create a new callback that will call onError,
 * and append the current stack to any error
 */
</span>    var stack;
    stack = new Error().stack.replace((/(.*?)\n.*?$/m), &apos;$1&apos;);
    return function (error, data, meta) {
        if (error &amp;&amp;
                error !== local.errorDefault &amp;&amp;
                String(error.stack).indexOf(stack.split(&apos;\n&apos;)[2]) &lt; 0) {
            // append the current stack to error.stack
            error.stack += &apos;\n&apos; + stack;
        }
        onError(error, data, meta);
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
local.onParallel = function (onError, onEach, onRetry) {
/*
 * this function will create a function that will
 * 1. run async tasks in parallel
 * 2. if counter === 0 or error occurred, then call onError with error
 */
    var onParallel;
    onError = local.<span class="apidocCodeKeywordSpan">onErrorWithStack</span>(onError);
    onEach = onEach || local.nop;
    onRetry = onRetry || local.nop;
    onParallel = function (error, data) {
        if (onRetry(error, data)) {
            return;
        }
        // decrement counter
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.onParallel" id="apidoc.element.db-lite.onParallel">
        function <span class="apidocSignatureSpan">db-lite.</span>onParallel
        <span class="apidocSignatureSpan">(onError, onEach, onRetry)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onParallel = function (onError, onEach, onRetry) {
<span class="apidocCodeCommentSpan">/*
 * this function will create a function that will
 * 1. run async tasks in parallel
 * 2. if counter === 0 or error occurred, then call onError with error
 */
</span>    var onParallel;
    onError = local.onErrorWithStack(onError);
    onEach = onEach || local.nop;
    onRetry = onRetry || local.nop;
    onParallel = function (error, data) {
        if (onRetry(error, data)) {
            return;
        }
        // decrement counter
        onParallel.counter -= 1;
        // validate counter
        local.assert(
            onParallel.counter &gt;= 0 || error || onParallel.error,
            &apos;invalid onParallel.counter = &apos; + onParallel.counter
        );
        // ensure onError is run only once
        if (onParallel.counter &lt; 0) {
            return;
        }
        // handle error
        if (error) {
            onParallel.error = error;
            // ensure counter &lt;= 0
            onParallel.counter = -Math.abs(onParallel.counter);
        }
        // call onError when isDone
        if (onParallel.counter &lt;= 0) {
            onError(error, data);
            return;
        }
        onEach();
    };
    // init counter
    onParallel.counter = 0;
    // return callback
    return onParallel;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

local.dbCrudRemoveAll = function (onError) {
/*
 * this function will remove all dbRow&apos;s from the db
 */
    var onParallel;
    onParallel = local.<span class="apidocCodeKeywordSpan">onParallel</span>(function (error) {
        local.setTimeoutOnError(onError, 0, error);
    });
    onParallel.counter += 1;
    Object.keys(local.dbTableDict).forEach(function (key) {
        onParallel.counter += 1;
        local.dbTableDict[key].crudRemoveAll(onParallel);
    });
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.replStart" id="apidoc.element.db-lite.replStart">
        function <span class="apidocSignatureSpan">db-lite.</span>replStart
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">replStart = function () {
<span class="apidocCodeCommentSpan">/*
 * this function will start the repl-debugger
 */
</span>    /*jslint evil: true*/
    var self;
    if (global.utility2_serverRepl1) {
        return;
    }
    // start replServer
    self = global.utility2_serverRepl1 = require(&apos;repl&apos;).start({ useGlobal: true });
    self.nop = function () {
    /*
     * this function will do nothing
     */
        return;
    };
    self.onError = function (error) {
    /*
     * this function will debug any repl-error
     */
        // debug error
        global.utility2_debugReplError = error;
        console.error(error);
    };
    // save repl eval function
    self.evalDefault = self.eval;
    // hook custom repl eval function
    self.eval = function (script, context, file, onError) {
        var match, onError2;
        match = (/^(\S+)(.*?)\n/).exec(script) || {};
        onError2 = function (error, data) {
            // debug error
            global.utility2_debugReplError = error || global.utility2_debugReplError;
            onError(error, data);
        };
        switch (match[1]) {
        // syntax sugar to run async shell command
        case &apos;$&apos;:
            switch (match[2]) {
            // syntax sugar to run git diff
            case &apos; git diff&apos;:
                match[2] = &apos; git diff --color | cat&apos;;
                break;
            // syntax sugar to run git log
            case &apos; git log&apos;:
                match[2] = &apos; git log -n 4 | cat&apos;;
                break;
            }
            // run async shell command
            require(&apos;child_process&apos;).spawn(match[2], {
                shell: true,
                stdio: [&apos;ignore&apos;, 1, 2]
            })
                // on shell exit, print return prompt
                .on(&apos;exit&apos;, function (exitCode) {
                    console.error(&apos;exit-code &apos; + exitCode);
                    self.evalDefault(
                        &apos;\n&apos;,
                        context,
                        file,
                        onError2
                    );
                });
            script = &apos;\n&apos;;
            break;
        // syntax sugar to grep current dir
        case &apos;grep&apos;:
            // run async shell command
            require(&apos;child_process&apos;).spawn(&apos;find . -type f | grep -v &apos; +
/* jslint-ignore-begin */
&apos;&quot;\
/\\.\\|\\(\\b\\|_\\)\\(\\.\\d\\|\
archive\\|artifact\\|\
bower_component\\|build\\|\
coverage\\|\
doc\\|\
external\\|\
fixture\\|\
git_module\\|\
jquery\\|\
log\\|\
min\\|mock\\|\
node_module\\|\
rollup\\|\
swp\\|\
tmp\\|\
vendor\\)s\\{0,1\\}\\(\\b\\|_\\)\
&quot; &apos; +
/* jslint-ignore-end */
                    &apos;| tr &quot;\\n&quot; &quot;\\000&quot; | xargs -0 grep -in &quot;&apos; +
                    match[2].trim() + &apos;&quot;&apos;, { shell: true, stdio: [&apos;ignore&apos;, 1, 2] })
                // on shell exit, print return prompt
                .on(&apos;exit&apos;, function (exitCode) {
                    console.error(&apos;exit-code &apos; + exitCode);
                    self.evalDefault(
                        &apos;\n&apos;,
                        context,
                        file,
                        onError2
                    );
                });
            script = &apos;\n&apos;;
            break;
        // syntax sugar to list object&apos;s keys, sorted by item-type
        case &apos;keys&apos;:
            script = &apos;console.error(Object.keys(&apos; + match[2] +
                &apos;).map(function (key) {&apos; +
                &apos;return typeof &apos; + match[2] + &apos;[key] + &quot; &quot; + key + &quot;\\n&quot;;&apos; +
                &apos;}).sort().join(&quot;&quot;) + Object.keys(&apos; + match[2] + &apos;).length)\n&apos;;
            break;
        // syntax sugar to print stringified arg
        case &apos;print&apos;:
            script = &apos;console.error(String(&apos; + match[2] + &apos;))\n&a...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
local.cliDict.help = local.cliDict.help || local.cliDict._help;
local.cliDict._interactive = local.cliDict._interactive || function () {
/*
 * [none]
 * start interactive-mode
 */
    local.global.local = local;
    local.<span class="apidocCodeKeywordSpan">replStart</span>();
};
if (local.replStart) {
    local.cliDict[&apos;--interactive&apos;] = local.cliDict[&apos;--interactive&apos;] ||
        local.cliDict._interactive;
    local.cliDict[&apos;-i&apos;] = local.cliDict[&apos;-i&apos;] || local.cliDict._interactive;
}
local.cliDict._version = local.cliDict._version || function () {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.serverLog" id="apidoc.element.db-lite.serverLog">
        function <span class="apidocSignatureSpan">db-lite.</span>serverLog
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">serverLog = function (options) {
<span class="apidocCodeCommentSpan">/*
 * this function will log server operations
 */
</span>    console.error(&apos;serverLog - &apos; + JSON.stringify(options));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.setTimeoutOnError" id="apidoc.element.db-lite.setTimeoutOnError">
        function <span class="apidocSignatureSpan">db-lite.</span>setTimeoutOnError
        <span class="apidocSignatureSpan">(onError, timeout, error, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setTimeoutOnError = function (onError, timeout, error, data) {
<span class="apidocCodeCommentSpan">/*
 * this function will async-call onError
 */
</span>    if (typeof onError === &apos;function&apos;) {
        setTimeout(function () {
            onError(error, data);
        }, timeout);
    }
    return data;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

local._DbTable.prototype.crudCountAll = function (onError) {
/*
 * this function will count all of dbRow&apos;s in the dbTable
 */
    this._cleanup();
    return local.<span class="apidocCodeKeywordSpan">setTimeoutOnError</span>(onError, 0, null, this.dbRowList.length);
};

local._DbTable.prototype.crudCountManyByQuery = function (query, onError) {
/*
 * this function will count the number of dbRow&apos;s in the dbTable with the given query
 */
    this._cleanup();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.sortCompare" id="apidoc.element.db-lite.sortCompare">
        function <span class="apidocSignatureSpan">db-lite.</span>sortCompare
        <span class="apidocSignatureSpan">(aa, bb, ii, jj)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sortCompare = function (aa, bb, ii, jj) {
<span class="apidocCodeCommentSpan">/*
 * this function will compare aa vs bb and return:
 * -1 if aa &lt; bb
 *  0 if aa === bb
 *  1 if aa &gt; bb
 * the priority for comparing different typeof&apos;s is:
 * null &lt; boolean &lt; number &lt; string &lt; object &lt; undefined
 */
</span>    var typeof1, typeof2;
    if (aa === bb) {
        return ii &lt; jj
            ? -1
            : 1;
    }
    if (aa === null) {
        return -1;
    }
    if (bb === null) {
        return 1;
    }
    typeof1 = typeof aa;
    typeof2 = typeof bb;
    if (typeof1 === typeof2) {
        return typeof1 === &apos;object&apos;
            ? 0
            : aa &gt; bb
            ? 1
            : -1;
    }
    if (typeof1 === &apos;boolean&apos;) {
        return -1;
    }
    if (typeof2 === &apos;boolean&apos;) {
        return 1;
    }
    if (typeof1 === &apos;number&apos;) {
        return -1;
    }
    if (typeof2 === &apos;number&apos;) {
        return 1;
    }
    if (typeof1 === &apos;string&apos;) {
        return -1;
    }
    if (typeof2 === &apos;string&apos;) {
        return 1;
    }
    return 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// bug-workaround - v8 does not have stable-sort
// optimization - for-loop
for (ii = 0; ii &lt; result.length; ii += 1) {
    result[ii].$meta.ii = ii;
}
if (element.isDescending) {
    result.sort(function (aa, bb) {
        return -local.<span class="apidocCodeKeywordSpan">sortCompare</span>(
            local.dbRowGetItem(aa, element.fieldName),
            local.dbRowGetItem(bb, element.fieldName),
            aa.$meta.ii,
            bb.$meta.ii
        );
    });
} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.storageClear" id="apidoc.element.db-lite.storageClear">
        function <span class="apidocSignatureSpan">db-lite.</span>storageClear
        <span class="apidocSignatureSpan">(onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">storageClear = function (onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will clear storage
 */
</span>    defer({ action: &apos;clear&apos; }, onError);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 */
    var onParallel;
    onParallel = local.onParallel(function (error) {
        local.setTimeoutOnError(onError, 0, error);
    });
    onParallel.counter += 1;
    onParallel.counter += 1;
    local.<span class="apidocCodeKeywordSpan">storageClear</span>(onParallel);
    Object.keys(local.dbTableDict).forEach(function (key) {
        onParallel.counter += 1;
        local.dbTableDict[key].drop(onParallel);
    });
    onParallel();
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.storageDefer" id="apidoc.element.db-lite.storageDefer">
        function <span class="apidocSignatureSpan">db-lite.</span>storageDefer
        <span class="apidocSignatureSpan">(options, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">storageDefer = function (options, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will defer options.action until storage is ready
 */
</span>    var data, isDone, objectStore, onError2, request, tmp;
    onError = onError || function (error) {
        // validate no error occurred
        local.assert(!error, error);
    };
    if (!storage) {
        deferList.push(function () {
            defer(options, onError);
        });
        init();
        return;
    }
    switch (modeJs) {
    case &apos;browser&apos;:
        onError2 = function () {
            /* istanbul ignore next */
            if (isDone) {
                return;
            }
            isDone = true;
            onError(
                request &amp;&amp; (request.error || request.transaction.error),
                data || request.result || &apos;&apos;
            );
        };
        switch (options.action) {
        case &apos;clear&apos;:
        case &apos;removeItem&apos;:
        case &apos;setItem&apos;:
            objectStore = storage
                .transaction(storageDir, &apos;readwrite&apos;)
                .objectStore(storageDir);
            break;
        default:
            objectStore = storage
                .transaction(storageDir, &apos;readonly&apos;)
                .objectStore(storageDir);
        }
        switch (options.action) {
        case &apos;clear&apos;:
            request = objectStore.clear();
            break;
        case &apos;getItem&apos;:
            request = objectStore.get(String(options.key));
            break;
        case &apos;keys&apos;:
            data = [];
            request = objectStore.openCursor();
            request.onsuccess = function () {
                if (!request.result) {
                    onError2();
                    return;
                }
                data.push(request.result.key);
                request.result.continue();
            };
            break;
        case &apos;length&apos;:
            request = objectStore.count();
            break;
        case &apos;removeItem&apos;:
            request = objectStore.delete(String(options.key));
            break;
        case &apos;setItem&apos;:
            request = objectStore.put(options.value, String(options.key));
            break;
        }
        [&apos;onabort&apos;, &apos;onerror&apos;, &apos;onsuccess&apos;].forEach(function (handler) {
            request[handler] = request[handler] || onError2;
        });
        // debug request
        local._debugStorageRequest = request;
        break;
    case &apos;node&apos;:
        switch (options.action) {
        case &apos;clear&apos;:
            child_process.spawnSync(&apos;rm -f &apos; + storage + &apos;/*&apos;, {
                shell: true,
                stdio: [&apos;ignore&apos;, 1, 2]
            });
            setTimeout(onError);
            break;
        case &apos;getItem&apos;:
            fs.readFile(
                storage + &apos;/&apos; + encodeURIComponent(String(options.key)),
                &apos;utf8&apos;,
                // ignore error
                function (error, data) {
                    onError(error &amp;&amp; null, data || &apos;&apos;);
                }
            );
            break;
        case &apos;keys&apos;:
            fs.readdir(storage, function (error, data) {
                onError(error, data &amp;&amp; data.map(decodeURIComponent));
            });
            break;
        case &apos;length&apos;:
            fs.readdir(storage, function (error, data) {
                onError(error, data &amp;&amp; data.length);
            });
            break;
        case &apos;removeItem&apos;:
            fs.unlink(
                storage + &apos;/&apos; + encodeURIComponent(String(options.key)),
                // ignore error
                function () {
                    onError();
                }
            );
            break;
        case &apos;setItem&apos;:
            tmp = os.tmpdir() + &apos;/&apos; + Date.now() + Math.random();
            //...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.storageGetItem" id="apidoc.element.db-lite.storageGetItem">
        function <span class="apidocSignatureSpan">db-lite.</span>storageGetItem
        <span class="apidocSignatureSpan">(key, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">storageGetItem = function (key, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will get the item with the given key from storage
 */
</span>    defer({ action: &apos;getItem&apos;, key: key }, onError);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    onParallel(error);
    local.normalizeValue(&apos;list&apos;, data)
        .filter(function (key) {
            return key.indexOf(&apos;dbTable.&apos;) === 0;
        })
        .forEach(function (key) {
            onParallel.counter += 1;
            local.<span class="apidocCodeKeywordSpan">storageGetItem</span>(key, function (error, data) {
                onParallel.counter += 1;
                onParallel(error);
                local.dbImport(data, onParallel);
            });
        });
    onParallel();
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.storageInit" id="apidoc.element.db-lite.storageInit">
        function <span class="apidocSignatureSpan">db-lite.</span>storageInit
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">storageInit = function () {
<span class="apidocCodeCommentSpan">/*
 * this function will init storage
 */
</span>    var onError, request;
    onError = function (error) {
        // validate no error occurred
        local.assert(!error, error);
        if (modeJs === &apos;browser&apos;) {
            storage = window[storageDir];
        }
        while (deferList.length) {
            deferList.shift()();
        }
    };
    if (modeJs === &apos;browser&apos;) {
        storage = window[storageDir];
    }
    if (storage) {
        onError();
        return;
    }
    switch (modeJs) {
    case &apos;browser&apos;:
        // init indexedDB
        try {
            request = window.indexedDB.open(storageDir);
            // debug request
            local._debugStorageRequestIndexedDB = request;
            request.onerror = onError;
            request.onsuccess = function () {
                window[storageDir] = request.result;
                onError();
            };
            request.onupgradeneeded = function () {
                if (!request.result.objectStoreNames.contains(storageDir)) {
                    request.result.createObjectStore(storageDir);
                }
            };
        } catch (ignore) {
        }
        break;
    case &apos;node&apos;:
        // mkdirp storage
        storage = storageDir;
        child_process.spawnSync(
            &apos;mkdir&apos;,
            [&apos;-p&apos;, storage],
            { stdio: [&apos;ignore&apos;, 1, 2] }
        );
        onError();
        break;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
         */
var onParallel;
// jslint-hack
local.nop(options);
onParallel = local.onParallel(onError);
onParallel.counter += 1;
// test storageInit&apos;s init handling-behavior
local.<span class="apidocCodeKeywordSpan">storageInit</span>();
// test storageInit&apos;s re-init handling-behavior
local.storageInit();
// test crud handling-behavior
onParallel.counter += 1;
local.storageClear(onParallel);
onParallel.counter += 1;
local.storageGetItem(&apos;undefined&apos;, onParallel);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.storageKeys" id="apidoc.element.db-lite.storageKeys">
        function <span class="apidocSignatureSpan">db-lite.</span>storageKeys
        <span class="apidocSignatureSpan">(onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">storageKeys = function (onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will get all the keys in storage
 */
</span>    defer({ action: &apos;keys&apos; }, onError);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        /*
* this function will load the db from storage
*/
   var onParallel;
   onParallel = local.onParallel(function (error) {
       local.setTimeoutOnError(onError, 0, error);
   });
   local.<span class="apidocCodeKeywordSpan">storageKeys</span>(function (error, data) {
       onParallel.counter += 1;
       onParallel.counter += 1;
       onParallel(error);
       local.normalizeValue(&apos;list&apos;, data)
           .filter(function (key) {
               return key.indexOf(&apos;dbTable.&apos;) === 0;
           })
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.storageLength" id="apidoc.element.db-lite.storageLength">
        function <span class="apidocSignatureSpan">db-lite.</span>storageLength
        <span class="apidocSignatureSpan">(onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">storageLength = function (onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will get the number of items in storage
 */
</span>    defer({ action: &apos;length&apos; }, onError);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
onParallel.counter += 1;
local.storageClear(onParallel);
onParallel.counter += 1;
local.storageGetItem(&apos;undefined&apos;, onParallel);
onParallel.counter += 1;
local.storageKeys(onParallel);
onParallel.counter += 1;
local.<span class="apidocCodeKeywordSpan">storageLength</span>(onParallel);
onParallel.counter += 1;
local.storageRemoveItem(&apos;undefined&apos;, onParallel);
onParallel.counter += 1;
local.storageSetItem(&apos;undefined&apos;, &apos;undefined&apos;, onParallel);
onParallel.counter += 1;
local.storageKeys(function () {
    if (local.modeJs === &apos;browser&apos;) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.storageRemoveItem" id="apidoc.element.db-lite.storageRemoveItem">
        function <span class="apidocSignatureSpan">db-lite.</span>storageRemoveItem
        <span class="apidocSignatureSpan">(key, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">storageRemoveItem = function (key, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will remove the item with the given key from storage
 */
</span>    defer({ action: &apos;removeItem&apos;, key: key }, onError);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    this.timerSave = null;
    while (this.onSaveList.length) {
        this.onSaveList.shift()();
    }
    // reset dbTable
    local._DbTable.call(this, this);
    // clear persistence
    local.<span class="apidocCodeKeywordSpan">storageRemoveItem</span>(&apos;dbTable.&apos; + this.name + &apos;.json&apos;, onError
);
};

local._DbTable.prototype.export = function (onError) {
/*
 * this function will export the db
 */
    var result, self;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite.storageSetItem" id="apidoc.element.db-lite.storageSetItem">
        function <span class="apidocSignatureSpan">db-lite.</span>storageSetItem
        <span class="apidocSignatureSpan">(key, value, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">storageSetItem = function (key, value, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will set the item with the given key and value to storage
 */
</span>    defer({ action: &apos;setItem&apos;, key: key, value: value }, onError);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}
if (onError) {
    self.onSaveList.push(onError);
}
// throttle storage-writes to once every 1000 ms
self.timerSave = self.timerSave || setTimeout(function () {
    self.timerSave = null;
    local.<span class="apidocCodeKeywordSpan">storageSetItem</span>(&apos;dbTable.&apos; + self.name + &apos;.json&apos;, self.export
(), function (
        error
    ) {
        while (self.onSaveList.length) {
            self.onSaveList.shift()(error);
        }
    });
}, 1000);
...</pre></li>
    </ul>


















</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.db-lite._DbTable" id="apidoc.module.db-lite._DbTable">module db-lite._DbTable</a></h1>


    <h2>
        <a href="#apidoc.element.db-lite._DbTable._DbTable" id="apidoc.element.db-lite._DbTable._DbTable">
        function <span class="apidocSignatureSpan">db-lite.</span>_DbTable
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_DbTable = function (options) {
<span class="apidocCodeCommentSpan">/*
 * this function will create a dbTable
 */
</span>    options = local.objectSetOverride(options);
    this.name = String(options.name);
    // register dbTable in dbTableDict
    local.dbTableDict[this.name] = this;
    this.dbRowList = [];
    this.isDirty = null;
    this.idIndexList = [{ isInteger: false, name: &apos;_id&apos;, dict: {} }];
    this.onSaveList = [];
    this.sizeLimit = options.sizeLimit || 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        /*
* this function will create a dbTable with the given options
*/
   var self;
   options = local.objectSetOverride(options);
   // register dbTable
   self = local.dbTableDict[options.name] =
       local.dbTableDict[options.name] || new local.<span class="apidocCodeKeywordSpan">_DbTable</span>(options);
   self.sortDefault = options.sortDefault ||
       self.sortDefault ||
       [{ fieldName: &apos;_timeUpdated&apos;, isDescending: true }];
   // remove idIndex
   local.normalizeValue(&apos;list&apos;, options.idIndexRemoveList).forEach(function (idIndex) {
       self.idIndexRemove(idIndex);
   });
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.db-lite._DbTable.prototype" id="apidoc.module.db-lite._DbTable.prototype">module db-lite._DbTable.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype._cleanup" id="apidoc.element.db-lite._DbTable.prototype._cleanup">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>_cleanup
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_cleanup = function () {
<span class="apidocCodeCommentSpan">/*
 * this function will cleanup soft-deleted records from the dbTable
 */
</span>    var dbRow, ii, list;
    if (!this.isDirty &amp;&amp; this.dbRowList.length &lt;= this.sizeLimit) {
        return;
    }
    this.isDirty = null;
    // cleanup dbRowList
    list = this.dbRowList;
    this.dbRowList = [];
    // optimization - for-loop
    for (ii = 0; ii &lt; list.length; ii += 1) {
        dbRow = list[ii];
        // cleanup isRemoved
        if (!dbRow.$meta.isRemoved) {
            this.dbRowList.push(dbRow);
        }
    }
    if (this.sizeLimit &amp;&amp; this.dbRowList.length &gt;= 1.5 * this.sizeLimit) {
        this.dbRowList = this._crudGetManyByQuery(
            {},
            this.sortDefault,
            0,
            this.sizeLimit
        );
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return result;
};

local._DbTable.prototype.crudCountAll = function (onError) {
/*
 * this function will count all of dbRow&apos;s in the dbTable
 */
    this.<span class="apidocCodeKeywordSpan">_cleanup</span>();
    return local.setTimeoutOnError(onError, 0, null, this.dbRowList.length);
};

local._DbTable.prototype.crudCountManyByQuery = function (query, onError) {
/*
 * this function will count the number of dbRow&apos;s in the dbTable with the given query
 */
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype._crudGetManyByQuery" id="apidoc.element.db-lite._DbTable.prototype._crudGetManyByQuery">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>_crudGetManyByQuery
        <span class="apidocSignatureSpan">( query, sort, skip, limit, shuffle )</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_crudGetManyByQuery = function ( query, sort, skip, limit, shuffle ) {
<span class="apidocCodeCommentSpan">/*
 * this function will get the dbRow&apos;s in the dbTable,
 * with the given query, sort, skip, and limit
 */
</span>    var ii, result;
    result = this.dbRowList;
    // get by query
    if (result.length &amp;&amp; query &amp;&amp; Object.keys(query).length) {
        result = local.dbRowListGetManyByQuery(this.dbRowList, query);
    }
    // sort
    local.normalizeValue(&apos;list&apos;, sort).forEach(function (element) {
        // bug-workaround - v8 does not have stable-sort
        // optimization - for-loop
        for (ii = 0; ii &lt; result.length; ii += 1) {
            result[ii].$meta.ii = ii;
        }
        if (element.isDescending) {
            result.sort(function (aa, bb) {
                return -local.sortCompare(
                    local.dbRowGetItem(aa, element.fieldName),
                    local.dbRowGetItem(bb, element.fieldName),
                    aa.$meta.ii,
                    bb.$meta.ii
                );
            });
        } else {
            result.sort(function (aa, bb) {
                return local.sortCompare(
                    local.dbRowGetItem(aa, element.fieldName),
                    local.dbRowGetItem(bb, element.fieldName),
                    aa.$meta.ii,
                    bb.$meta.ii
                );
            });
        }
    });
    // skip
    result = result.slice(skip || 0);
    // shuffle
    ((shuffle &amp;&amp; local.listShuffle) || local.nop)(result);
    // limit
    result = result.slice(0, limit || Infinity);
    return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        dbRow = list[ii];
        // cleanup isRemoved
        if (!dbRow.$meta.isRemoved) {
            this.dbRowList.push(dbRow);
        }
    }
    if (this.sizeLimit &amp;&amp; this.dbRowList.length &gt;= 1.5 * this.sizeLimit) {
        this.dbRowList = this.<span class="apidocCodeKeywordSpan">_crudGetManyByQuery</span>(
            {},
            this.sortDefault,
            0,
            this.sizeLimit
        );
    }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype._crudGetOneById" id="apidoc.element.db-lite._DbTable.prototype._crudGetOneById">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>_crudGetOneById
        <span class="apidocSignatureSpan">(idDict)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_crudGetOneById = function (idDict) {
<span class="apidocCodeCommentSpan">/*
 * this function will get the dbRow in the dbTable with the given idDict
 */
</span>    var id, result;
    idDict = local.objectSetOverride(idDict);
    result = null;
    this.idIndexList.some(function (idIndex) {
        id = idDict[idIndex.name];
        // optimization - hasOwnProperty
        if (idIndex.dict.hasOwnProperty(id)) {
            result = idIndex.dict[id];
            return result;
        }
    });
    return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * this function will get the dbRow&apos;s in the dbTable with the given idDictList
 */
    var self;
    this._cleanup();
    self = this;
    return local.setTimeoutOnError(onError, 0, null, local.dbRowProject(
        local.normalizeValue(&apos;list&apos;, idDictList).map(function (idDict) {
            return self.<span class="apidocCodeKeywordSpan">_crudGetOneById</span>(idDict);
        })
    ));
};

local._DbTable.prototype.crudGetManyByQuery = function (options, onError) {
/*
 * this function will get the dbRow&apos;s in the dbTable with the given options.query
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype._crudRemoveOneById" id="apidoc.element.db-lite._DbTable.prototype._crudRemoveOneById">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>_crudRemoveOneById
        <span class="apidocSignatureSpan">(idDict, circularList)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_crudRemoveOneById = function (idDict, circularList) {
<span class="apidocCodeCommentSpan">/*
 * this function will remove the dbRow from the dbTable with the given idDict
 */
</span>    var id, result, self;
    if (!idDict) {
        return null;
    }
    self = this;
    circularList = circularList || [idDict];
    result = null;
    self.idIndexList.forEach(function (idIndex) {
        id = idDict[idIndex.name];
        // optimization - hasOwnProperty
        if (!idIndex.dict.hasOwnProperty(id)) {
            return;
        }
        result = idIndex.dict[id];
        delete idIndex.dict[id];
        // optimization - soft-delete
        result.$meta.isRemoved = true;
        self.isDirty = true;
        if (circularList.indexOf(result) &gt;= 0) {
            return;
        }
        circularList.push(result);
        // recurse
        self._crudRemoveOneById(result, circularList);
    });
    self.save();
    return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        result.$meta.isRemoved = true;
        self.isDirty = true;
        if (circularList.indexOf(result) &gt;= 0) {
            return;
        }
        circularList.push(result);
        // recurse
        self.<span class="apidocCodeKeywordSpan">_crudRemoveOneById</span>(result, circularList);
    });
    self.save();
    return result;
};

local._DbTable.prototype._crudSetOneById = function (dbRow) {
/*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype._crudSetOneById" id="apidoc.element.db-lite._DbTable.prototype._crudSetOneById">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>_crudSetOneById
        <span class="apidocSignatureSpan">(dbRow)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_crudSetOneById = function (dbRow) {
<span class="apidocCodeCommentSpan">/*
 * this function will set the dbRow into the dbTable with the given dbRow._id
 * WARNING - existing dbRow with conflicting dbRow._id will be removed
 */
</span>    var existing, id, normalize, timeNow;
    normalize = function (dbRow) {
    /*
     * this function will recursively normalize dbRow
     */
        if (typeof dbRow === &apos;object&apos; &amp;&amp; dbRow) {
            Object.keys(dbRow).forEach(function (key) {
                // remove invalid property
                if (key[0] === &apos;$&apos; || key.indexOf(&apos;.&apos;) &gt;= 0 || dbRow[key] === null) {
                    // optimization - soft-delete
                    dbRow[key] = undefined;
                    return;
                }
                // recurse
                normalize(dbRow[key]);
            });
        }
    };
    dbRow = local.jsonCopy(typeof dbRow === &apos;object&apos; &amp;&amp; dbRow
        ? dbRow
        : {});
    // update timestamp
    timeNow = new Date().toISOString();
    dbRow._timeCreated = dbRow._timeCreated || timeNow;
    if (!local.modeImport) {
        dbRow._timeUpdated = timeNow;
    }
    // normalize
    normalize(dbRow);
    dbRow = local.jsonCopy(dbRow);
    // remove existing dbRow
    existing = this._crudRemoveOneById(dbRow) || dbRow;
    // init meta
    dbRow.$meta = { isRemoved: null };
    this.idIndexList.forEach(function (idIndex) {
        // auto-set id
        id = local.dbRowSetId(existing, idIndex);
        // copy id from existing to dbRow
        dbRow[idIndex.name] = id;
        // set dbRow
        idIndex.dict[id] = dbRow;
    });
    // update dbRowList
    this.dbRowList.push(dbRow);
    this.save();
    return dbRow;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    result = result || {};
    // remove existing dbRow
    this._crudRemoveOneById(result);
    // update dbRow
    dbRow._timeCreated = undefined;
    local.objectSetOverride(result, dbRow, 10);
    // replace dbRow
    result = this.<span class="apidocCodeKeywordSpan">_crudSetOneById</span>(result);
    return result;
};

local._DbTable.prototype.crudCountAll = function (onError) {
/*
 * this function will count all of dbRow&apos;s in the dbTable
 */
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype._crudUpdateOneById" id="apidoc.element.db-lite._DbTable.prototype._crudUpdateOneById">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>_crudUpdateOneById
        <span class="apidocSignatureSpan">(dbRow)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_crudUpdateOneById = function (dbRow) {
<span class="apidocCodeCommentSpan">/*
 * this function will update the dbRow in the dbTable,
 * if it exists with the given dbRow._id
 * WARNING
 * existing dbRow&apos;s with conflicting unique-keys (besides the one being updated)
 * will be removed
 */
</span>    var id, result;
    dbRow = local.jsonCopy(local.objectSetOverride(dbRow));
    result = null;
    this.idIndexList.some(function (idIndex) {
        id = dbRow[idIndex.name];
        // optimization - hasOwnProperty
        if (idIndex.dict.hasOwnProperty(id)) {
            result = idIndex.dict[id];
            return true;
        }
    });
    result = result || {};
    // remove existing dbRow
    this._crudRemoveOneById(result);
    // update dbRow
    dbRow._timeCreated = undefined;
    local.objectSetOverride(result, dbRow, 10);
    // replace dbRow
    result = this._crudSetOneById(result);
    return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * this function will update the dbRowList in the dbTable,
 * if they exist with the given dbRow._id&apos;s
 */
    var self;
    self = this;
    return local.setTimeoutOnError(onError, 0, null, local.dbRowProject(
        local.normalizeValue(&apos;list&apos;, dbRowList).map(function (dbRow) {
            return self.<span class="apidocCodeKeywordSpan">_crudUpdateOneById</span>(dbRow);
        })
    ));
};

local._DbTable.prototype.crudUpdateManyByQuery = function (query, dbRow, onError) {
/*
 * this function will update the dbRow&apos;s in the dbTable with the given query
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.crudCountAll" id="apidoc.element.db-lite._DbTable.prototype.crudCountAll">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudCountAll
        <span class="apidocSignatureSpan">(onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">crudCountAll = function (onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will count all of dbRow&apos;s in the dbTable
 */
</span>    this._cleanup();
    return local.setTimeoutOnError(onError, 0, null, this.dbRowList.length);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        query: { field2: { $gte: -Infinity, $lte: Infinity } },\n\
        skip: 0,\n\
        sort: [{ fieldName: &quot;_timeUpdated&quot;, idDescending: true }]\n\
    }, onNext);\n\
    break;\n\
case 10:\n\
    console.log(data);\n\
    dbTable1.<span class="apidocCodeKeywordSpan">crudCountAll</span>(onNext);\n\
    break;\n\
case 11:\n\
    console.log(&quot;number of rows: &quot; + data);\n\
    break;\n\
default:\n\
    console.error(error.stack);\n\
}\n\
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.crudCountManyByQuery" id="apidoc.element.db-lite._DbTable.prototype.crudCountManyByQuery">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudCountManyByQuery
        <span class="apidocSignatureSpan">(query, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">crudCountManyByQuery = function (query, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will count the number of dbRow&apos;s in the dbTable with the given query
 */
</span>    this._cleanup();
    return local.setTimeoutOnError(
        onError,
        0,
        null,
        this._crudGetManyByQuery(query).length
    );
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// test idIndexCreate&apos;s null-case handling-behavior
options.dbTable.idIndexCreate({ name: &apos;_id&apos; });
// test idIndexRemove&apos;s null-case handling-behavior
options.dbTable.idIndexRemove({ name: &apos;_id&apos; });
// validate dbRowCount
local.assertJsonEqual(options.dbTable.crudCountAll(), 0);
// test crudCountManyByQuery&apos;s null-case handling-behavior
options.data = options.dbTable.<span class="apidocCodeKeywordSpan">crudCountManyByQuery</span>();
// validate dbRowCount
local.assertJsonEqual(options.dbTable.crudCountAll(), 0);
// validate data
local.assertJsonEqual(options.data, 0);
// test crudGetManyById&apos;s null-case handling-behavior
options.data = options.dbTable.crudGetManyById();
// validate dbRowCount
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.crudGetManyById" id="apidoc.element.db-lite._DbTable.prototype.crudGetManyById">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudGetManyById
        <span class="apidocSignatureSpan">(idDictList, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">crudGetManyById = function (idDictList, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will get the dbRow&apos;s in the dbTable with the given idDictList
 */
</span>    var self;
    this._cleanup();
    self = this;
    return local.setTimeoutOnError(onError, 0, null, local.dbRowProject(
        local.normalizeValue(&apos;list&apos;, idDictList).map(function (idDict) {
            return self._crudGetOneById(idDict);
        })
    ));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// test crudCountManyByQuery&apos;s null-case handling-behavior
options.data = options.dbTable.crudCountManyByQuery();
// validate dbRowCount
local.assertJsonEqual(options.dbTable.crudCountAll(), 0);
// validate data
local.assertJsonEqual(options.data, 0);
// test crudGetManyById&apos;s null-case handling-behavior
options.data = options.dbTable.<span class="apidocCodeKeywordSpan">crudGetManyById</span>();
// validate dbRowCount
local.assertJsonEqual(options.dbTable.crudCountAll(), 0);
// validate data
local.assertJsonEqual(options.data, []);
// test crudGetManyByQuery&apos;s null-case handling-behavior
options.data = options.dbTable.crudGetManyByQuery();
// validate dbRowCount
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.crudGetManyByQuery" id="apidoc.element.db-lite._DbTable.prototype.crudGetManyByQuery">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudGetManyByQuery
        <span class="apidocSignatureSpan">(options, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">crudGetManyByQuery = function (options, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will get the dbRow&apos;s in the dbTable with the given options.query
 */
</span>    this._cleanup();
    options = local.objectSetOverride(options);
    return local.setTimeoutOnError(onError, 0, null, local.dbRowProject(
        this._crudGetManyByQuery(
            options.query,
            options.sort || this.sortDefault,
            options.skip,
            options.limit,
            options.shuffle
        ),
        options.fieldList
    ));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* browser example:
*     &lt;script src=&quot;assets.db-lite.js&quot;&gt;&lt;/script&gt;
*     &lt;script&gt;
*     var dbTable1;
*     dbTable1 = window.dbTable1 = window.utility2_db.dbTableCreateOne({ name: &quot;dbTable1&quot; });
*     dbTable1.idIndexCreate({ name: &quot;field1&quot; });
*     dbTable1.crudSetOneById({ field1: &quot;hello&quot;, field2: &quot;world&quot; });
*     console.log(dbTable1.<span class="apidocCodeKeywordSpan">crudGetManyByQuery</span>({
*         limit: Infinity,
*         query: { field1: &quot;hello&quot; },
*         skip: 0,
*         sort: [{ fieldName: &apos;field1&apos;, isDescending: false }]
*     }));
*     &lt;/script&gt;
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.crudGetOneById" id="apidoc.element.db-lite._DbTable.prototype.crudGetOneById">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudGetOneById
        <span class="apidocSignatureSpan">(idDict, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">crudGetOneById = function (idDict, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will get the dbRow in the dbTable with the given idDict
 */
</span>    this._cleanup();
    return local.setTimeoutOnError(onError, 0, null, local.dbRowProject(
        this._crudGetOneById(idDict)
    ));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// test crudGetManyByQuery&apos;s null-case handling-behavior
options.data = options.dbTable.crudGetManyByQuery();
// validate dbRowCount
local.assertJsonEqual(options.dbTable.crudCountAll(), 0);
// validate data
local.assertJsonEqual(options.data, []);
// test crudGetOneById&apos;s null-case handling-behavior
options.data = options.dbTable.<span class="apidocCodeKeywordSpan">crudGetOneById</span>();
// validate dbRowCount
local.assertJsonEqual(options.dbTable.crudCountAll(), 0);
// validate data
local.assertJsonEqual(options.data, null);
// test crudGetOneByRandom&apos;s null-case handling-behavior
options.data = options.dbTable.crudGetOneByRandom();
// validate dbRowCount
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.crudGetOneByQuery" id="apidoc.element.db-lite._DbTable.prototype.crudGetOneByQuery">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudGetOneByQuery
        <span class="apidocSignatureSpan">(query, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">crudGetOneByQuery = function (query, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will get the dbRow in the dbTable with the given query
 */
</span>    var ii, result;
    this._cleanup();
    // optimization - for-loop
    for (ii = 0; ii &lt; this.dbRowList.length; ii += 1) {
        result = local.dbRowListGetManyByQuery([this.dbRowList[ii]], query)[0];
        if (result) {
            break;
        }
    }
    return local.setTimeoutOnError(onError, 0, null, local.dbRowProject(result));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// test crudGetOneByRandom&apos;s null-case handling-behavior
options.data = options.dbTable.crudGetOneByRandom();
// validate dbRowCount
local.assertJsonEqual(options.dbTable.crudCountAll(), 0);
// validate data
local.assertJsonEqual(options.data, null);
// test crudGetOneByQuery&apos;s null-case handling-behavior
options.data = options.dbTable.<span class="apidocCodeKeywordSpan">crudGetOneByQuery</span>();
// validate dbRowCount
local.assertJsonEqual(options.dbTable.crudCountAll(), 0);
// validate data
local.assertJsonEqual(options.data, null);
// test crudRemoveManyById&apos;s null-case handling-behavior
options.data = options.dbTable.crudRemoveManyById();
// validate dbRowCount
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.crudGetOneByRandom" id="apidoc.element.db-lite._DbTable.prototype.crudGetOneByRandom">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudGetOneByRandom
        <span class="apidocSignatureSpan">(onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">crudGetOneByRandom = function (onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will get a random dbRow in the dbTable
 */
</span>    this._cleanup();
    return local.setTimeoutOnError(onError, 0, null, local.dbRowProject(
        this.dbRowList[Math.floor(Math.random() * this.dbRowList.length)]
    ));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// test crudGetOneById&apos;s null-case handling-behavior
options.data = options.dbTable.crudGetOneById();
// validate dbRowCount
local.assertJsonEqual(options.dbTable.crudCountAll(), 0);
// validate data
local.assertJsonEqual(options.data, null);
// test crudGetOneByRandom&apos;s null-case handling-behavior
options.data = options.dbTable.<span class="apidocCodeKeywordSpan">crudGetOneByRandom</span>();
// validate dbRowCount
local.assertJsonEqual(options.dbTable.crudCountAll(), 0);
// validate data
local.assertJsonEqual(options.data, null);
// test crudGetOneByQuery&apos;s null-case handling-behavior
options.data = options.dbTable.crudGetOneByQuery();
// validate dbRowCount
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.crudRemoveAll" id="apidoc.element.db-lite._DbTable.prototype.crudRemoveAll">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudRemoveAll
        <span class="apidocSignatureSpan">(onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">crudRemoveAll = function (onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will remove all of the dbRow&apos;s from the dbTable
 */
</span>    var idIndexList;
    // save idIndexList
    idIndexList = this.idIndexList;
    // reset dbTable
    local._DbTable.call(this, this);
    // restore idIndexList
    local.dbTableCreateOne({
        name: this.name,
        idIndexCreateList: idIndexList
    }, onError);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var onParallel;
    onParallel = local.onParallel(function (error) {
        local.setTimeoutOnError(onError, 0, error);
    });
    onParallel.counter += 1;
    Object.keys(local.dbTableDict).forEach(function (key) {
        onParallel.counter += 1;
        local.dbTableDict[key].<span class="apidocCodeKeywordSpan">crudRemoveAll</span>(onParallel);
    });
    onParallel();
};

local.dbDrop = function (onError) {
/*
 * this function will drop the db
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.crudRemoveManyById" id="apidoc.element.db-lite._DbTable.prototype.crudRemoveManyById">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudRemoveManyById
        <span class="apidocSignatureSpan">(idDictList, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">crudRemoveManyById = function (idDictList, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will remove the dbRow&apos;s from the dbTable with the given idDictList
 */
</span>    var self;
    self = this;
    return local.setTimeoutOnError(onError, 0, null, local.dbRowProject(
        local.normalizeValue(&apos;list&apos;, idDictList).map(function (dbRow) {
            return self._crudRemoveOneById(dbRow);
        })
    ));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// test crudGetOneByQuery&apos;s null-case handling-behavior
options.data = options.dbTable.crudGetOneByQuery();
// validate dbRowCount
local.assertJsonEqual(options.dbTable.crudCountAll(), 0);
// validate data
local.assertJsonEqual(options.data, null);
// test crudRemoveManyById&apos;s null-case handling-behavior
options.data = options.dbTable.<span class="apidocCodeKeywordSpan">crudRemoveManyById</span>();
// validate dbRowCount
local.assertJsonEqual(options.dbTable.crudCountAll(), 0);
// validate data
local.assertJsonEqual(options.data, []);
// test crudRemoveManyByQuery&apos;s null-case handling-behavior
options.data = options.dbTable.crudRemoveManyByQuery();
// validate dbRowCount
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.crudRemoveManyByQuery" id="apidoc.element.db-lite._DbTable.prototype.crudRemoveManyByQuery">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudRemoveManyByQuery
        <span class="apidocSignatureSpan">(query, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">crudRemoveManyByQuery = function (query, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will remove the dbRow&apos;s from the dbTable with the given query
 */
</span>    var self;
    self = this;
    return local.setTimeoutOnError(onError, 0, null, local.dbRowProject(
        self._crudGetManyByQuery(query).map(function (dbRow) {
            return self._crudRemoveOneById(dbRow);
        })
    ));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/*
 * dbTable query
 * query and remove dbRowList from dbTable
 */
    local.dbTableCreateOne({ name: process.argv[3] }, function (error, self) {
        // validate no error occurred
        local.assert(!error, error);
        console.log(JSON.stringify(self.<span class="apidocCodeKeywordSpan">crudRemoveManyByQuery</span>(
            JSON.parse(process.argv[4])
        ), null, 4));
    });
};
local.cliDict.dbTableCrudSetManyById = function () {
/*
 * dbTable dbRowList
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.crudRemoveOneById" id="apidoc.element.db-lite._DbTable.prototype.crudRemoveOneById">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudRemoveOneById
        <span class="apidocSignatureSpan">(idDict, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">crudRemoveOneById = function (idDict, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will remove the dbRow from the dbTable with the given idDict
 */
</span>    return local.setTimeoutOnError(onError, 0, null, local.dbRowProject(
        this._crudRemoveOneById(idDict)
    ));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
case 4:\n\
    dbTable1.crudSetOneById({ field1: &quot;bb&quot;, field2: 2, field3: &quot;bar&quot; }, onNext);\n\
    break;\n\
case 5:\n\
    dbTable1.crudSetOneById({ field1: &quot;cc&quot;, field2: 3, field3: &quot;baz&quot; }, onNext);\n\
    break;\n\
case 6:\n\
    dbTable1.<span class="apidocCodeKeywordSpan">crudRemoveOneById</span>({ field1: &quot;aa&quot; }, onNext);\n\
    break;\n\
case 7:\n\
    dbTable1.crudUpdateOneById({ field1: &quot;bb&quot;, field2: -1 }, onNext);\n\
    break;\n\
case 8:\n\
    dbTable1.crudSetOneById({ field2: Math.random() }, onNext);\n\
    break;\n\
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.crudSetManyById" id="apidoc.element.db-lite._DbTable.prototype.crudSetManyById">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudSetManyById
        <span class="apidocSignatureSpan">(dbRowList, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">crudSetManyById = function (dbRowList, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will set the dbRowList into the dbTable
 */
</span>    var self;
    self = this;
    return local.setTimeoutOnError(onError, 0, null, local.dbRowProject(
        local.normalizeValue(&apos;list&apos;, dbRowList).map(function (dbRow) {
            return self._crudSetOneById(dbRow);
        })
    ));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    self.idIndexRemove(idIndex);
});
// create idIndex
local.normalizeValue(&apos;list&apos;, options.idIndexCreateList).forEach(function (idIndex) {
    self.idIndexCreate(idIndex);
});
// upsert dbRow
self.<span class="apidocCodeKeywordSpan">crudSetManyById</span>(options.dbRowList);
// restore dbTable from persistent-storage
self.isLoaded = self.isLoaded || options.isLoaded;
if (!self.isLoaded) {
    local.storageGetItem(&apos;dbTable.&apos; + self.name + &apos;.json&apos;, function (error, data) {
        // validate no error occurred
        local.assert(!error, error);
        if (!self.isLoaded) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.crudSetOneById" id="apidoc.element.db-lite._DbTable.prototype.crudSetOneById">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudSetOneById
        <span class="apidocSignatureSpan">(dbRow, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">crudSetOneById = function (dbRow, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will set the dbRow into the dbTable with the given dbRow._id
 */
</span>    return local.setTimeoutOnError(onError, 0, null, local.dbRowProject(
        this._crudSetOneById(dbRow)
    ));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*
* browser example:
*     &lt;script src=&quot;assets.db-lite.js&quot;&gt;&lt;/script&gt;
*     &lt;script&gt;
*     var dbTable1;
*     dbTable1 = window.dbTable1 = window.utility2_db.dbTableCreateOne({ name: &quot;dbTable1&quot; });
*     dbTable1.idIndexCreate({ name: &quot;field1&quot; });
*     dbTable1.<span class="apidocCodeKeywordSpan">crudSetOneById</span>({ field1: &quot;hello&quot;, field2: &quot;world&quot; });
*     console.log(dbTable1.crudGetManyByQuery({
*         limit: Infinity,
*         query: { field1: &quot;hello&quot; },
*         skip: 0,
*         sort: [{ fieldName: &apos;field1&apos;, isDescending: false }]
*     }));
*     &lt;/script&gt;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.crudUpdateManyById" id="apidoc.element.db-lite._DbTable.prototype.crudUpdateManyById">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudUpdateManyById
        <span class="apidocSignatureSpan">(dbRowList, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">crudUpdateManyById = function (dbRowList, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will update the dbRowList in the dbTable,
 * if they exist with the given dbRow._id&apos;s
 */
</span>    var self;
    self = this;
    return local.setTimeoutOnError(onError, 0, null, local.dbRowProject(
        local.normalizeValue(&apos;list&apos;, dbRowList).map(function (dbRow) {
            return self._crudUpdateOneById(dbRow);
        })
    ));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// test crudRemoveOneById&apos;s null-case handling-behavior
options.data = options.dbTable.crudRemoveOneById();
// validate dbRowCount
local.assertJsonEqual(options.dbTable.crudCountAll(), 0);
// validate data
local.assertJsonEqual(options.data, null);
// test crudUpdateManyById&apos;s null-case handling-behavior
options.data = options.dbTable.<span class="apidocCodeKeywordSpan">crudUpdateManyById</span>();
// validate dbRowCount
local.assertJsonEqual(options.dbTable.crudCountAll(), 0);
// validate data
local.assertJsonEqual(options.data, []);
// test crudUpdateManyByQuery&apos;s null-case handling-behavior
options.data = options.dbTable.crudUpdateManyByQuery();
// validate dbRowCount
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.crudUpdateManyByQuery" id="apidoc.element.db-lite._DbTable.prototype.crudUpdateManyByQuery">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudUpdateManyByQuery
        <span class="apidocSignatureSpan">(query, dbRow, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">crudUpdateManyByQuery = function (query, dbRow, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will update the dbRow&apos;s in the dbTable with the given query
 */
</span>    var result, self, tmp;
    self = this;
    tmp = local.jsonCopy(local.objectSetOverride(dbRow));
    result = self._crudGetManyByQuery(query).map(function (dbRow) {
        tmp._id = dbRow._id;
        return self._crudUpdateOneById(tmp);
    });
    return local.setTimeoutOnError(onError, 0, null, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// test crudUpdateManyById&apos;s null-case handling-behavior
options.data = options.dbTable.crudUpdateManyById();
// validate dbRowCount
local.assertJsonEqual(options.dbTable.crudCountAll(), 0);
// validate data
local.assertJsonEqual(options.data, []);
// test crudUpdateManyByQuery&apos;s null-case handling-behavior
options.data = options.dbTable.<span class="apidocCodeKeywordSpan">crudUpdateManyByQuery</span>();
// validate dbRowCount
local.assertJsonEqual(options.dbTable.crudCountAll(), 0);
// validate data
local.assertJsonEqual(options.data, []);
// test crudSetOneById&apos;s and crudUpdateOneById&apos;s null-case handling-behavior
[&apos;crudSetOneById&apos;, &apos;crudUpdateOneById&apos;].forEach(function (operation) {
    options.data = options.dbTable[operation]();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.crudUpdateOneById" id="apidoc.element.db-lite._DbTable.prototype.crudUpdateOneById">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>crudUpdateOneById
        <span class="apidocSignatureSpan">(dbRow, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">crudUpdateOneById = function (dbRow, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will update the dbRow in the dbTable,
 * if it exists with the given dbRow._id
 */
</span>    return local.setTimeoutOnError(onError, 0, null, local.dbRowProject(
        this._crudUpdateOneById(dbRow)
    ));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
case 5:\n\
    dbTable1.crudSetOneById({ field1: &quot;cc&quot;, field2: 3, field3: &quot;baz&quot; }, onNext);\n\
    break;\n\
case 6:\n\
    dbTable1.crudRemoveOneById({ field1: &quot;aa&quot; }, onNext);\n\
    break;\n\
case 7:\n\
    dbTable1.<span class="apidocCodeKeywordSpan">crudUpdateOneById</span>({ field1: &quot;bb&quot;, field2: -1 }, onNext);\n\
    break;\n\
case 8:\n\
    dbTable1.crudSetOneById({ field2: Math.random() }, onNext);\n\
    break;\n\
case 9:\n\
    dbTable1.crudGetManyByQuery({\n\
        limit: Infinity,\n\
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.drop" id="apidoc.element.db-lite._DbTable.prototype.drop">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>drop
        <span class="apidocSignatureSpan">(onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">drop = function (onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will drop the dbTable
 */
</span>    console.error(&apos;dropping dbTable &apos; + this.name + &apos; ...&apos;);
    // cancel pending save
    this.timerSave = null;
    while (this.onSaveList.length) {
        this.onSaveList.shift()();
    }
    // reset dbTable
    local._DbTable.call(this, this);
    // clear persistence
    local.storageRemoveItem(&apos;dbTable.&apos; + this.name + &apos;.json&apos;, onError);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        local.setTimeoutOnError(onError, 0, error);
    });
    onParallel.counter += 1;
    onParallel.counter += 1;
    local.storageClear(onParallel);
    Object.keys(local.dbTableDict).forEach(function (key) {
        onParallel.counter += 1;
        local.dbTableDict[key].<span class="apidocCodeKeywordSpan">drop</span>(onParallel);
    });
    onParallel();
};

local.dbExport = function (onError) {
/*
 * this function will export the db as serialized text
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.export" id="apidoc.element.db-lite._DbTable.prototype.export">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>export
        <span class="apidocSignatureSpan">(onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">export = function (onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will export the db
 */
</span>    var result, self;
    this._cleanup();
    self = this;
    result = &apos;&apos;;
    self.idIndexList.forEach(function (idIndex) {
        result += self.name + &apos; idIndexCreate &apos; + JSON.stringify({
            isInteger: idIndex.isInteger,
            name: idIndex.name
        }) + &apos;\n&apos;;
    });
    result += self.name + &apos; sizeLimit &apos; + self.sizeLimit + &apos;\n&apos;;
    result += self.name + &apos; sortDefault &apos; + JSON.stringify(self.sortDefault) + &apos;\n&apos;;
    self.crudGetManyByQuery({}).forEach(function (dbRow) {
        result += self.name + &apos; dbRowSet &apos; + JSON.stringify(dbRow) + &apos;\n&apos;;
    });
    return local.setTimeoutOnError(onError, 0, null, result.trim());
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}
if (onError) {
    self.onSaveList.push(onError);
}
// throttle storage-writes to once every 1000 ms
self.timerSave = self.timerSave || setTimeout(function () {
    self.timerSave = null;
    local.storageSetItem(&apos;dbTable.&apos; + self.name + &apos;.json&apos;, self.<span class="apidocCodeKeywordSpan">export</
span>(), function (
        error
    ) {
        while (self.onSaveList.length) {
            self.onSaveList.shift()(error);
        }
    });
}, 1000);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.idIndexCreate" id="apidoc.element.db-lite._DbTable.prototype.idIndexCreate">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>idIndexCreate
        <span class="apidocSignatureSpan">(options, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">idIndexCreate = function (options, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will create an idIndex with the given options.name
 */
</span>    var dbRow, idIndex, ii, name;
    options = local.objectSetOverride(options);
    name = String(options.name);
    // disallow idIndex with dot-name
    if (name.indexOf(&apos;.&apos;) &gt;= 0 || name === &apos;_id&apos;) {
        return local.setTimeoutOnError(onError);
    }
    // remove existing idIndex
    this.idIndexRemove(options);
    // init idIndex
    idIndex = {
        dict: {},
        isInteger: !!options.isInteger,
        name: name
    };
    this.idIndexList.push(idIndex);
    // populate idIndex with dbRowList
    // optimization - for-loop
    for (ii = 0; ii &lt; this.dbRowList.length; ii += 1) {
        dbRow = this.dbRowList[ii];
        // auto-set id
        if (!dbRow.$meta.isRemoved) {
            idIndex.dict[local.dbRowSetId(dbRow, idIndex)] = dbRow;
        }
    }
    this.save();
    return local.setTimeoutOnError(onError);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* this zero-dependency package will provide a persistent, in-browser database
*
* browser example:
*     &lt;script src=&quot;assets.db-lite.js&quot;&gt;&lt;/script&gt;
*     &lt;script&gt;
*     var dbTable1;
*     dbTable1 = window.dbTable1 = window.utility2_db.dbTableCreateOne({ name: &quot;dbTable1&quot; });
*     dbTable1.<span class="apidocCodeKeywordSpan">idIndexCreate</span>({ name: &quot;field1&quot; });
*     dbTable1.crudSetOneById({ field1: &quot;hello&quot;, field2: &quot;world&quot; });
*     console.log(dbTable1.crudGetManyByQuery({
*         limit: Infinity,
*         query: { field1: &quot;hello&quot; },
*         skip: 0,
*         sort: [{ fieldName: &apos;field1&apos;, isDescending: false }]
*     }));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.idIndexRemove" id="apidoc.element.db-lite._DbTable.prototype.idIndexRemove">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>idIndexRemove
        <span class="apidocSignatureSpan">(options, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">idIndexRemove = function (options, onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will remove the idIndex with the given options.name
 */
</span>    var name;
    options = local.objectSetOverride(options);
    name = String(options.name);
    this.idIndexList = this.idIndexList.filter(function (idIndex) {
        return idIndex.name !== name || idIndex.name === &apos;_id&apos;;
    });
    this.save();
    return local.setTimeoutOnError(onError);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
options = local.objectSetOverride(options);
name = String(options.name);
// disallow idIndex with dot-name
if (name.indexOf(&apos;.&apos;) &gt;= 0 || name === &apos;_id&apos;) {
    return local.setTimeoutOnError(onError);
}
// remove existing idIndex
this.<span class="apidocCodeKeywordSpan">idIndexRemove</span>(options);
// init idIndex
idIndex = {
    dict: {},
    isInteger: !!options.isInteger,
    name: name
};
this.idIndexList.push(idIndex);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.db-lite._DbTable.prototype.save" id="apidoc.element.db-lite._DbTable.prototype.save">
        function <span class="apidocSignatureSpan">db-lite._DbTable.prototype.</span>save
        <span class="apidocSignatureSpan">(onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">save = function (onError) {
<span class="apidocCodeCommentSpan">/*
 * this function will save the dbTable to storage
 */
</span>    var self;
    self = this;
    if (local.modeImport) {
        return;
    }
    if (onError) {
        self.onSaveList.push(onError);
    }
    // throttle storage-writes to once every 1000 ms
    self.timerSave = self.timerSave || setTimeout(function () {
        self.timerSave = null;
        local.storageSetItem(&apos;dbTable.&apos; + self.name + &apos;.json&apos;, self.export(), function (
            error
        ) {
            while (self.onSaveList.length) {
                self.onSaveList.shift()(error);
            }
        });
    }, 1000);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        if (circularList.indexOf(result) &gt;= 0) {
            return;
        }
        circularList.push(result);
        // recurse
        self._crudRemoveOneById(result, circularList);
    });
    self.<span class="apidocCodeKeywordSpan">save</span>();
    return result;
};

local._DbTable.prototype._crudSetOneById = function (dbRow) {
/*
 * this function will set the dbRow into the dbTable with the given dbRow._id
 * WARNING - existing dbRow with conflicting dbRow._id will be removed
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
